\documentclass[finnish,12pt]{article}
\usepackage{aaltothesis}
\usepackage[sort&compress]{natbib}
\bibliographystyle{unsrt} % plain} % finplain

% \usepackage[utf8]{inputenc}

%% Kyt seuraavaa latex-komennon ja eps-kuvien kanssa 
%\usepackage[dvips]{graphicx}

%% Jos ts kytt pdflatex-komentoa, 
%% joka knt tekstin suoraan pdf-tiedostoksi ja kuvasi
%% ovat esim. jpg-formaatissa tai pdf-formaatissa,   
%% kytetn seuraavaa pakettia, kommentoi siis kommenttimerkki pois
%% Huom! Tekstin marginaalit saattavat poiketa n. 2-5 mm
%% suosituksesta, jos kytt pdflatex-komentoa!
\usepackage[pdftex]{graphicx} 

%% Saat pdf-tiedoston viittaukset ja linkit kuntoon seuraavalla paketilla.
%% Paketti toimii erityisen hyvin pdflatexin kanssa. 
%%
%% Use this if you want to get links and nice output with pdflatex
\usepackage[pdfpagemode=None,colorlinks=true,urlcolor=red,%
linkcolor=blue,citecolor=black,pdfstartview=FitH]{hyperref}

%% Jos et jostain syyst tykk kytt
%% edellist hyperref pakettia, voit kytt mys seuraavaa pakettia
%% (tarvitaan lhinn url-komennon mrittmiseen ja formatoimiseen)
%%
%% Use this if you do not like hyperref package - this
%% defines url environment and formats it correctly

% \usepackage{url}
%% Matematiikan fontteja, symboleja ja muotoiluja lis, nit tarvitaan usein 
%%
%% Use this if you write hard core mathematics, these are usually needed
\usepackage{amsfonts,amssymb,amsbsy}  
\usepackage{amsmath}
%% Vaakasuunnan mitat, L KOSKE!
\setlength{\hoffset}{-1in}
\setlength{\oddsidemargin}{35mm}
\setlength{\evensidemargin}{25mm}
\setlength{\textwidth}{15cm}
%% Pystysuunnan mitat, L KOSKE!
\setlength{\voffset}{-1in}
\setlength{\headsep}{7mm}
\setlength{\headheight}{1em}
\setlength{\topmargin}{25mm-\headheight-\headsep}
\setlength{\textheight}{23cm}


%% Kaikki mik paperille tulostuu, on tmn jlkeen
%%
%% Output starts here
\begin{document}

%% Korjaa vastaamaan korkeakouluasi
%%
%% Change the school field to describe your school 
\university{aalto university}{Aalto-yliopisto}
\school{School of science and technology}{Teknillinen korkeakoulu}

%% Korjaa seuraavat vastaamaan omaa tiedekuntaasi
%%
%% Change the faculty field to describe your faculty
\faculty{Faculty of Electronics, Communications and Automation}%
{Elektroniikan, tietoliikenteen ja automaation tiedekunta}%
%%

%% Vain kanditylle: Korjaa seuraavat vastaamaan tutkinto-ohjelmaasi
%%
%% Only for B.Sc. thesis: Choose your degree programme. 
\degreeprogram{Automation and control engineering}%
{Automaatio- ja säätötekniikka}
%%

%% Vain DI/M.Sc.- ja lisensiaatintylle: valitse laitos, 
%% professuuri ja sen professuurikoodi. 
%%
%% Only for M.Sc. and Licentiate thesis: Choose your department,
%% professorship and professorship code. 
%\department{Department of Radio Science and Technology}%
%{Radiotieteen ja -tekniikan laitos}
%\professorship{Circuit theory}{Piiriteoria}
%\code{S-55}
%%

%% Valitse yksi nist kolmesta
%%
%% Choose one of these:
\univdegree{BSc}
%\univdegree{MSc}
%\univdegree{Lic}

\author{Konsta Hölttä}

%% älä tavuta otsikkoa ja
%% Muista ett otsikkoja ei tavuteta! 
%% Jos otsikossa on ja-sana, se ei jää rivin viimeiseksi sanaksi 
%% vaan aloittaa uuden rivin.
\thesistitle{}{Liikkuvien robottien paikallinen esteenväistö ja liikkeensuunnittelu}

\place{Espoo}
%% Kandidaatintyn pivmr on sen esityspivmr! 
\date{9.12.2010}

%% Kandidaattiseminaarin vastuuopettaja tai diplomityn valvoja.
%% Huomaa titteliss "\" -merkki pisteen jlkeen, 
%% ennen vlilynti ja seuraavaa merkkijonoa. 
%% Nin tehdn, koska kyseess ei ole lauseen loppu, jonka jlkeen tulee 
%% hieman pidempi vli vaan halutaan tavallinen vli.
\supervisor{D.Sc.\ Ilkka Seilonen}{TkT Ilkka Seilonen}

%% Kandidaatintyn ohjaaja(t) tai diplomityn ohjaaja(t)
\instructor{D.Sc.\ (Tech.) Jari Saarinen}{TkT Jari Saarinen}
%\instructor{M.Sc.\ (Tech.) Polli Pohjaaja}{DI Polli Pohjaaja}

%% Aaltologo: syntaksi: \uselogo{red|blue|yellow}{?|!|''}
\uselogo{red}{''}{tkk}
\makecoverpage

\keywords{liikkuva robotti, paikannus, lokaali liikkeensuunnittelu, esteenväistö, dynaaminen ympäristö}

\begin{abstractpage}[finnish]

Liikkuviin robotteihin ja niihin liittyvään esteenväistöön kuuluu laaja-alaisuutensa vuoksi suuri joukko asioita esteiden havainnoinnista sopivan reitin ennustukseen. Tässä työssä kartoitetaan reaaliaikaisia menetelmiä liikkuvien robottien lähellä olevien esteiden kiertämiseen ja siitä aiheutuvaan lyhyen kantaman liikkeensuunnitteluun. Tämä suoritetaan mallintamalla esteet lähiympäristön karttaan, etsimällä kartasta uusi, hetkellisesti turvallinen reitti ja suunnittelemalla tämän reitin toteuttava säätö robotin liikettä ohjaaville laitteille.

Työn pääpaino on yhtäkkiä ilmaantuvissa esteissä ja ympäristössä, josta ei juurikaan tiedetä mitään etukäteen. Ensin luodaan katsaus siihen, mitä liikkuvat robotit ovat ja mitä ne tarvitsevat rakenteeltaan ja antureiltaan väistääkseen esteitä. Käydään läpi muutamia yleisiä lokaaleja esteenväistöstrategioita ja niiden soveltuvuutta eri ympäristöihin siten, että päästään määränpäähän mahdollisimman optimaalisella tavalla osumatta reitillä oleviin maaston haastavuuksiin ja stationaarisiin ja liikkuviin esteisiin.

Lopuksi luodaan myös väljempi katsaus aiheen kokonaiskuvaan. Pohditaan esitettyjen menetelmien käyttökelpoisuutta ja robustisuutta eri näkökulmista ja esitetään haastavasta maastosta johtuvia käytännön ongelmia; on myös todennäköistä joutua väistämään liikkuviakin esteitä. Esitellään myös muutama useita menetelmiä yhdistävä sovellus.

%Pääpaino on ympäristöllä, josta ei juurikaan tiedetä mitään etukäteen; on myös todennäköistä joutua väistämään liikkuviakin esteitä. Pohditaan esteentunnistustapojen ja robotin ohjaustapojen soveltuvuutta eri ympäristöihin siten, että päästään määränpäähän mahdollisimman optimaalisella tavalla osumatta reitillä oleviin maaston haastavuuksiin ja stationaarisiin ja liikkuviin esteisiin.

%Samalla sivutaan myös aiheeseen liittyviä peruskäsitteitä ja yleisiä ongelmia, joita esteenväistössä on otettava huomioon: eritellään menetelmien mukana erilaisten ympäristön havainnointitekniikoiden robustisuutta robotin esteiden ja maaston ``näkemiseen'' ja robotin itsensä paikan sekä reitin seuraamiseen. Luodaan katsaus myös aiheen kokonaiskuvaan pohtien käyttökelpoisuutta eri näkökulmista.
\end{abstractpage}

\newpage

%\mysection{Esipuhe}
%Tähän ei mitään tarvinne...

%Joka kappaleeseen lisättäneen vielä tarkennuksia johonkin suuntaan kunhan ajatukset selvenee. Etenkin loppupuoliskoon.

%\vspace{5cm}
%Otaniemi, 9.12.2010

%\vspace{5mm}
%{\hfill Konsta Hölttä \hspace{1cm}}

\newpage


%% Sisllysluettelo
%% addcontentsline tekee pdf-tiedostoon viitteen sisllysluetteloa varten
\addcontentsline{toc}{section}{Sisällysluettelo}
\tableofcontents

%\mysection{Symbolit ja lyhenteet}

%\subsection*{Lyhenteet}

%\begin{tabular}{ll}
%VFH &	vector field histogram \\
%DWA &	dynamic window approach \\
%AGV &	automated guided vehicle \\
%RRT &	rapidly-exploring random tree \\
%SLAM &	simultaneous localization and map building \\
%SIFT &	scale-invariant feature transform
%\end{tabular}


%% Sivulaskurin viilausta opinnytteen vaatimusten mukaan:
\cleardoublepage
\storeinipagenumber
\pagenumbering{arabic}
\setcounter{page}{1}



\section{Johdanto}

Referenssejä!

\thispagestyle{empty}

Esteenväistö ja liikkeensuunnittelu ovat klassisia ongelmia joihin on oleellisesti kiinnitettävä huomiota aina itsenäisesti liikkuvaa robottia suunnitellessa. Robotin on osattava navigoida itsenäisesti ja sen on päästävä perille nopeasti vahingoittamatta itseään tai ympäristöään. Robotilla on tietty konfiguraatioavaruus (configuration space), eli joukko mahdollisista sijaintien, asentojen ja nopeuksien yhdistelmistä eli periaatteessa kaikesta vapaasta tilasta; esteet ovat konfiguraatioavaruuden ulkopuolella. Lokaaliin anturipohjaiseen esteenväistöön on luonnollisesti monia eri menetelmiä, joiden hyödyllisyys ja soveltuvuus riippuu robotin ympäristöstä ja anturien laadusta \cite{hwang1992gross, desouza2002vision, bonin2008visual}.

Ympäristöä havainnoidaan jatkuvasti robotin antureilla, ja kun esteitä aistitaan, pyritään laskemaan väistämissuunnitelma mahdollisimman nopeasti. Jotkin väistötavat soveltuvat erityisesti tiettyihin antureihin ja reaaliaikaisuuteen, ja anturien hyvät ja huonot puolet on muutenkin otettava huomioon mm. havaitsemisetäisyyden, kohinan ja epävarmuuksien takia. Toisaalta havainnoinnin ja esteiden tulkinnan väliin voi luoda abstraktiokerroksen, jonka avulla mitatut havainnoinnit esitetään \cite{elfes2002occugrid}. Havainnointimenetelmiä ovat mm. ultraääni- ja infrapuna-anturit, laserskannerit ja videokamerat. Hyvillä menetelmillä anturointi onnistuu jatkuvasti; toisilla robotti joutuu välillä pysähtymään mittauksia varten. Pyritään siihen, että robotti voi ajaa jatkuvasti pysähtymättä.

Esteiden ohi selviämisen lisäksi robotin on pysyttävä reitillään ja sen on jotenkin saatava tietoa sijainnistaan ja suunnastaan, mikäli tavoitteena on päästä tavoitepisteeseen eikä harhailla sokeasti. Tämänkin toteutus riippuu robotin sijaintiantureista ja niiden sopivuudesta ympäristöön. Yleisesti soveltuvia tapoja paikannukseen ovat odometria, maamerkit, gps ja radiomajakat. Näkyviä maanmuotoja voidaan myös verrata karttaan robotin paikoittamiseksi \cite{borenstein1997postech}. Kaikki tavat ovat jossain määrin epätarkkoja, joten virhearviot on otettava huomioon ja mielellään käytettävä montaa tapaa rinnakkain. Kalman-suodin onkin suosittu apu reitin ja sijainnin tarkastelun yhteydessä \cite{jetto2002kalman}.

Tässä työssä kartoitetaan yleisellä tasolla eri esteenväistömenetelmiä ulkotiloissa maanpinnalla liikkuville roboteille. Kiinnitetään erityisesti huomiota vaihtelevassa ja dynaamisessa ympäristössä kulkeviin robotteihin. Tässä yhteydessä dynaamisella ympäristöllä tarkoitetaan sellaista, jossa esteet ovat vaihtelevia ja voivat liikkua, ja robotilla jotakin itsenäisesti liikkuvaa ajoneuvoa, kuten vihivaunua tai automaattisesti ajavaa henkilöautoa. Kiinteästi asennettavia robotteja kuten manipulaattorikäsivarsia ei käsitellä.

Työssä sivutaan myös globaalia liikkeensuunnittelua, eli tilannetta jossa reitinsuunnittelukartta on tiedossa etukäteen. Painopiste on kuitenkin yhtäkkisten, odottamattomien esteiden havaitsemisessa ja väistämisessä kun jonkinlainen tavoitepiste on tiedossa ennalta. Reitin ja ympäristön muutoksia voidaan myös päivittää robotille reaaliajassa ylemmältä taholta. Aina ei kuitenkaan voida saada ennakkotietoa alueista, joissa robotti kulkee; tällöin alueet on kartoitettava matkan varrella. Globaalin reitin suunnittelu oletetaan hoidetuksi; ei oteta kantaa, tuleeko reitti jostain ylempää vai lasketaanko sitäkin reaaliajassa robotilla.

\clearpage

\section{Lokaalin esteenväistön ongelma}

Robotin paikallisen navigoinnin pohjalla on hyvin paljon muitakin väistöalgoritmeihin liittymättömiä ongelmia, joita tässä tekstissä sivutaan vain sen verran kuin on välttämättä tarpeen. Seuraavassa esitellään pohjustukseksi joitain perusasioita pyörillä kulkevan robotin liikkumisesta, joihin kaikki myöhemmin esitettävä teksti pohjautuu.

\subsection{Mekaniikka}

Tässä työssä robotti on jokin autonomisesti liikkuva väline jolla on tietty määränpää. Ympäristö jossa robotti ajaa määrää pitkälti robotin mekaanisen rakenteen: esimerkiksi pyöreäalustainen joka suuntaan kääntyvä ajoneuvo, henkilöauto, perävaunu tai metsäkone. Ympäristö ja rakenne puolestaan määräävät, miten robottiin voi kiinnittää anturit havainnoimaan ympäristöä. Nämä kaikki yhdessä tuovat rajoitteet, joiden perusteella lokaali liikkeensuunnittelu ratkaistaan.

Pyörät ovat yksinkertaisen mutta toimivan tekniikkansa vuoksi ylivoimaisesti useimpien nykyrobottien liikkumisen perustana \cite{siegwart2004introduction}. Haastavassa maastossa käytetään jotain pyöristä jalostettua tapaa, kuten telaketjuja tai renkaita, joihin on kiinnitetty piikkejä tms. \cite{abad2009axelwheel, saranli2001rhex}. Rakenteen puolesta (mm. renkaiden lukumäärä ja kääntymistapa) pyörillä liikkumiseenkin on hyvin monia tapoja, joissa on kaikissa omat hyvät ja huonot puolensa. Tapoja rajoittaa enimmäkseen robotin muoto ja kohdeympäristö; jotkut anturoinnit ja väistöalgoritmit soveltuvat vain tietynlaisille kinematiikoille eli robotin rakenteelle. Erityisesti joka suuntaan ohjautuvan robotin (omnidirectional robot) käsittely eroaa merkittävästi perinteisen auton kaltaisesta kulkuvälineestä, jonka kiihtyvyyssuunnat rajoittuvat eturenkaiden mukaan.

Nivelletyillä jaloilla käveleviä robotteja tutkitaan nykyään yhä enemmän. Humanoidirobotit soveltuvat ihmisille tarkoitettuun ympäristöön, ja näyttäisivät ihmisille luontevilta jolloin kanssakäyminen olisi helppoa. Nivelletyt jalat saattavat sopia haastavaan, epätasaiseen maastoon pyöreitä renkaita paremmin. Tätä on kokeiltu esimeriksi metsäkoneissa \cite{billingsley2008robotics}.

Itse esteiden väistämisen aiheuttaman reitin lokaali suunnittelu on puhtaan laskennallista, mutta pohjalla on kuitenkin oikea ulkomaailma epätarkkuuksineen ja anturivirheineen. Jotkin menetelmät perustuvat hyvinkin vahvasti tietynlaiseen anturointitapaan, kuten siihen, että ultraääneltä saadaan suhteellisen epävarmoja mittauksia \cite{borenstein1988obstacleus}. Virheet ja epävarmuudet on pidettävä aina mielessä.


\subsection{Paikannus ja anturointi}

Olennainen ongelma liikkuville roboteille on itsensä paikannus \cite{borenstein1996whereami}. Kun robotin oletetaan tietävän kohdepiste tarkasti, pitää myös tietää missä itse robotti sijaitsee. Tähän voidaan käyttää tapauksesta riippuen esim. odometriaa \cite{borenstein1001umbmark}, inertiasuunnistusta \cite{barshan1995inertial}, radiomajakoita \cite{borenstein1997postech} tai maamerkkejä (kamerakuvalla tai maanpinnasta ``kosketuksella'' havaittavia) \cite{betke2002mobilelandmarks, desouza2002vision}. Maamerkkejä kannattaa suhteuttaa myös ennalta tunnettuun karttaan, mikäli sellainen on saatavilla -- tällöin voidaan tarkentaa paikkatietoa löydetyistä maamerkeistä ja niiden oletetuista sijainneista; myös mikäli havaittu ympäristö ei vastaa kartasta tulkittavaa oletettua näkymää, on havaittu este \cite{leonard199geombeac, ohya2002vision}. Sensorifuusiota Kalman-suotimella voidaan myös hyödyntää, jolloin saadaan tarkempi tulos monen anturin yhdistetystä mittauksesta \cite{jetto2002kalman}. Usein uutta karttatietoa kerätään samalla kun antureilta saadaan dataa (simultaneous localization and mapping, SLAM) \cite{se2002mobilelocalization, wang2003online}.

Esteet on havainnoitava robotin lähistöltä jollain lailla. Infrapunaheijastuksiin ja ultraäänikaikuun perustuvat sensorit ovat yksinkertaisuutensa ja edullisuutensa ansiosta hyvin yleisesti käytettyjä, mutta myös häiriöalttiita ja epävarmoja \cite{benet2002usinginfrared, borenstein1988obstacleus}. Ne toimivat tutkamaisesti lähettämällä signaalin ja seuraamalla kaikua esteestä, johon siten arvioidaan etäisyys kaiun matkaan kuluneen ajan perusteella. Näitä antureita on tyypillisesti useita robotin ympärillä osoittamassa eri suuntiin.

Laserskannerit ja kamerat ovat tarkkoja ja näkevät kauas: niitä käytetään monesti ulkotiloissa \cite{bonin2008visual}. Kaksiulotteinen laserskanneri on myös tutkamainen ja kuvaa automaattisesti joka suuntaa 360 asteen keilalla; kolmiulotteinen laserskanneri kuvaa eteenpäin kahdella akselilla ja tuottaa kameran kaltaisen kuvan syvyyksistä \cite{guivant2000localization, surmann2003autonomous}. Vielä tarkempaa kuvaa saadaan videokameroilla, joiden kanssa tarvitaan laskentatehoakin huomattavasti edellä mainittuja enemmän. Konenäkö on ylivoimainen, kun tarvitaan tarkempaa tietoa edessä olevista pinnoista, kuten kuviointia tai asentoa. Kahdella oikein sijoitellulla kameralla saadaan aikaan syvyysnäkö \cite{murray2002stereo}.


\subsection{Lokaali esteenväistö} % TODO: parempi

Esteenväistön ensimmäinen askel on esteiden sijainnin etsiminen. Tästä eteenpäin oletetaan, että esteet ja muu lähiympäristön informaatio sekä robotin sijainti suhteessa referenssikoordinaatistoon on havaittu jollain menetelmällä, ja tietyllä varmuudella tiedetään ympäristön muoto ja mahdollisesti reitillä olevat esteet -- havainnointimenetelmään sen enempää ottamatta kantaa mitä siitä välttämättä tarvitsee huomioida. Liikkumismenetelmäkin oletetaan hoidetuksi sekä reitti annetuksi ylemmältä taholta. Seuraavassa käsitellään itse esteiden ohittamista.

Kuvassa \ref{fig:tilannehahmotelma} on yksinkertaistettu esimerkki tyypillisestä paikallisen esteenväistön ongelmasta. Robottia kuvaa alhaalla oleva ympyrä, määränpäätä ylhäällä oleva ympyrä ja loput kuviot ovat esteitä. Robotti havainnoi edessä päin olevien esteiden reunat näkökentässään: rastit kuvaavat tutkaamalla havaittuja estepisteitä. Nuolet kuvaavat liikkuvien objektien nopeusvektoreita. Kuvan abstraktoitu tilanne voi vastata toimiston käytäviä tai kaupungin liikennettä.

Kuvan tilanteessa robotin on suotuisinta jatkaa matkaa keskellä olevan neliön ohitse, sillä se ei ehdi jarruttaa ja kiertää oikealta. Seuraavaksi täytyy hidastaa, jotta vasemmalta tuleva este pääsee ohitse (mikäli se jatkaa matkaa robotin ohi, eikä käännä suuntaansa nykyisestä). Lopulta kuljetaan nelikulmaisten esteiden välistä päätepistettä päin ja saatetaan joutua väistämään ylempänä olevaa liikkuvaa kappaletta. Tässä työssä pyritään saamaan vastaavanlainen ohjauslogiikka aikaiseksi.

\begin{figure}[h]
\centering \includegraphics[width=0.5\textwidth]{tilannehahmotelma}
\caption{Tavanomainen esteenväistötilanne. \label{fig:tilannehahmotelma}}
\end{figure}


% \clearpage

\section{Yleinen esteenväistö}

\subsection{Alkuolettamuksia}

Sisätila eroaa ulkotilasta esteenväistön kannalta merkittävästi siinä, että tilasta voidaan tehdä tiettyjä yksinkertaistavia oletuksia. Robotti on oletettavasti aina samassa kulmassa maanpintaan nähden (tasainen lattia), esteet ovat mitä todennäköisimmin korkeahkoja robottiin nähden ja kohtisuorassa maanpintaan nähden (seinät, hyllyt, ihmiset) ja rakennuksen pohjakuvasta saataneen hyvä kartta, joka voidaan approksimoida kaksiulotteiseksi. Renkailla liikkuminen on helppoa ja yhtäkkisiin kuoppiin tai kynnyksiin ei tarvinne kiinnittää erityisemmin huomiota. Näkymää voi tutkaskannata kohtuullisen luotettavasti jo ultraäänellä. Esteet tuskin liikkuvat ihmistä nopeammin. Mitkään näistä olettamuksista eivät päde ulkona tutkimattomassa ympäristössä.

Ulkona robotin mekaniikkaan, esteenväistöön ja ja -havainnointiin on kiinnitettävä enemmän huomiota. Ulkotilat voidaan erotella edelleen mm. kaupunkimaastoon, työmaahan, peltoon, avolouhoksiin ja kaivoksiin, metsänkaltaiseen maastoajoon jne. Kaupunkimaasto on kompromissi sisätilojen ja erityisen haastavan ympäristön välillä, ja sen teknisiä haasteita ovat erityisesti vinot ja käyrät pinnat joissa robotti lipsuu ja joissa kiinteät anturit voivat ottaa häiriömittauksia maanpinnasta mäkeä alas ajettaessa; ylös ajettaessa reunan yli ei nähdä ennen kuin maasto on taas tasaista. Liikkuvat esteet voivat olla autoja tai polkupyöriä, joita pitäisi väistää hyvin nopeasti ja jotka täytyisi havainnoida jo kaukaa, jotta väistöliikkeen ehtisi tehdä. Tämä on erityisen kriittistä varsinkin robotisoiduissa henkilöautoissa \cite{sun2006road}. Täysin raaka vaikeasti kartoitettava epätasainen maasto taas on edelleen hankalimman pään erikoistapaus, kun maastosta ei voida tehdä muita olettamuksia kuin että se on hyvin haastava.

Tasaisessa maastossa ``kaksiulotteisessa'' maailmassa esteet on aina kierrettävä sivulta ja mittauksia on helppo tehdä tutka-antureilla, kun vinoja maastoja ei ole. Seuraavassa käsitellään esteenväistöä tällaisessa maailmassa, sillä se yksinkertaistaa tilannetta huomattavasti -- kaikki tilanteet kannattaa approksimoida kaksiulotteisiksi mikäli vain mahdollista. Monesti ulkotilatkin voidaan vinoudestaan huolimatta käsitellä kaksiulotteisena, ellei robotti lennä tai sukella. Jos edessä on hyvin matalakin este, se kannattanee kiertää elleivät renkaat jousta erityisen paljon.

% 2d-matematihelppo-\cite[s. 309, 342]{kelly1995intelligent}

\subsection{Potentiaalikenttä}

Potentiaalikenttä (artificial potential function, artificial potential field, APF) on vanha mutta hyvin usein (sellaisenaan tai toisen navigointitavan lähtökohtana) käytetty väistömenetelmä \cite{rimon1992apf,warren2002apf}. Oikeita fysikaalisia voimia nämä kentät eivät tuota robotille, jolloin kenttiä sanotaan toisinaan keinotekoisiksi tai virtuaalisiksi.

Potentiaalikentät syntyvät kohteesta ja esteistä; kohde tuottaa puoleensavetävän ja esteet hylkivän potentiaalin. Käytetty potentiaalifunktio on suhteellisen yksinkertainen, esimeriksi robotin ja esteen välisen etäisyyden käänteisarvo tai tämän neliö \cite{ge2002new}. Määränpään ja esteiden aiheuttavien potentiaalien gradienttien summasta saadaan robottiin kohdistuva ``voima'' jonka mukaan sitä kiihdytetään. Potentiaalikenttiä käytetään myös robottimanipulaattoreilla, mutta niitä ei tässä käsitellä. Intuitiitivesti potentiaalikenttiä voi verrata vuoristoisen maaston korkeuskarttaan, jossa pyritään ``vierimään'' mahdollisimman alas pohjalle, määränpäähän.

Formaalisti potentiaalifunktiot $U_a$ (puoleensavetävä, attraktiivinen) ja $U_r$ (hylkivä, repulsiivinen) ovat esimerkiksi \cite{ge2002new}
\begin{equation} \label{eq:uapot}
U_a(q) = \xi(q_m - q),
\end{equation}
\begin{equation} \label{eq:urpot}
U_r(q) = \begin{cases}
 \eta(\frac{1}{|q_e - q|} - \frac{1}{\rho_0})^2 & \text{jos } |q_e - q| \le \rho_0 \\
0 & \text{jos } |q_e - q| > \rho_0
\end{cases}
\end{equation}
missä $q$-vektori kuvaa robotin sijaintia, $q_m$ kohteen sijaintia ja $q_e$ yhden esteen sijaintia. $\xi$ ja $\eta$ ovat optimoitavia skaalauskertoimia ja $\rho_0$ on suurin käytännöllinen etäisyys, jossa este havaitaan tai jossa se tuottaa merkittävää voimaa. Potentiaalifunktion $U(q)$ aiheuttama voima $F$ saadaan yleisesti potentiaalikenttäfunktion negatiivisesta gradientista paikan suhteen
\begin{equation} \label{eq:potnabla}
F(q) = -\nabla_q U(q),
\end{equation}
oli potentiaalifunktio mikä tahansa (kuten kaava \ref{eq:uapot} tai \ref{eq:urpot}, tai jokin muu), sillä halutaan päästä ``korkeuskarttaa'' pitkin alaspäin. Kokonaisvoima $F_{kok}$ on kohteen ja kaikkien esteiden aiheuttamien voimien summa, kun esteitä on $N$ kpl. $F_a$ on laskettu kaavalla \ref{eq:potnabla} esim. kaavasta \ref{eq:uapot}, ja $F_{ri}$ on järjestysluvultaan $i$:nnen esteen repulsiivinen voima (myös kaavalla \ref{eq:potnabla}):
\begin{equation} \label{eq:potsumma}
F_{kok}(q) = F_a(q) + \sum_{i=1}^N F_{ri}(q).
\end{equation}

\begin{figure}[h!tb]
\centering \includegraphics[width=\textwidth]{potentiaalia}
\caption{Yksinkertaistettu esimerkkikuva potentiaalikartasta. \label{fig:potentiaalia}}
\end{figure}

Kuvassa \ref{fig:potentiaalia} on esimerkki potentiaalifunktion arvoista erittäin yksinkertaisessa ympäristössä. Kohde on origossa ja siellä on siis matalin potentiaali. Neljä huippua ovat pistemäisiä esteitä joista kolmen ryppäänä olevan takana on yksi lokaali minimi, johon voi jäädä loukkuun ilman muita menetelmiä. Käytetyt potentiaalifunktiot ovat kaavat \ref{eq:uapot} ja \ref{eq:urpot} arvoilla $\xi = 1, \eta = 10, \rho_0 = 3$. Todellisudessa esteitä lienee joka puolella ja monen pistemäisen estemittauksen yhdistelmä tuottaa viivamaisia kuvioita seinien yms. kohdille.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.6\textwidth]{potvektorit}
\caption{Kohdepisteen ja yhden esteen aiheuttamat voimavektorit. \label{fig:potvektorit}}
\end{figure}

Kuvassa \ref{fig:potvektorit} visualisoidaan, kuinka voimat toteutuvat kohteen ja yhden estepisteen funktiona kaavalla \ref{eq:potsumma}. Voimavektorit $F_a$ ja $F_r$ lasketaan potentiaalifunktioista ja summataan yhteen, jolloin syntyy kokonaisvoima $F_{kok}$. Kokonaisvoima tuottaa hetkellisen kiihtyvyyden robotille kunnes seuraavat voimavektorit on laskettu seuraavalla laskukierroksella.

Koska voima voidaan laskea hetkellisesti joka pisteessä ja potentiaalifunktioiden laskeminen on yksinkertaista, tämä menetelmä soveltuu dynaamiseen ja reaaliaikaiseen tilanteeseen. Etäisyys esteeseen saadaan esim. ultraäänianturilta, ja esteiden liikkuessa repulsiivinen kokonaisvoima muuttuu siten, että robotti ohjaa esteistä poispäin jatkuvasti. Menetelmä ei ota kantaa esteiden liikkumiseen vaan yksinkertaisesti määrää robottia hylkimään esteitä silloin kun ne ovat havaintosäteellä.

(Etäisyysmittareiden epävarmuudet eivät merkittävästi tätä tekniikkaa haittaa, sillä mittauksia saadaan jatkuvasti ja kun jokaiselle etäisyyspisteelle lasketaan voima, häviävät satunnaiset häiriömittaukset suhteessa mitättöminä pois. Esteinä voidaan käyttää pisteitä, jotka on havaittu parin viime skannausiteraation sisällä. Abstraktin luonteensa ansiosta menetelmä on sovellettavissa myös villin luonnon haastaviin tilanteisiin.)

Eri painokertoimet $\xi$, $\eta$ ja $\rho_0$ on optimoitava robotin kinematiikan ja esteiden mukaan \cite{ge2002new}; robotin liike on jatkuvaa eikä se voi välttämättä kääntyä välittömästi mihin suuntaan tahansa. Sillä on myös massasta aiheutuva hitaus sekä jokin maksiminopeus, joista täytyy optimoida kenttien voimakkuus siten, ettei esteitä kierretä turhaan hyvin kaukaa, mutta samalla siten, ettei niihin voi törmätä. Tässäkin on tehtävä myös oletuksia esteiden liikkumisnopeudesta ja robotin reaktioajasta, jos se on relevanttia -- potentiaalikentät eivät ehdi apuun nokkakolareihin jos hylkimisvoima ei ole tarpeeksi suuri. Painoparametrien optimoinniksi on esitetty etukäteen suunniteltavan hyvyysfunktion minimointia \cite{vadakkepat2002eapf}, mikä sopii ennalta laskettavaksi muttei kelpaa muuttuvaan ennalta tuntemattomaan ympäristöön tekemättä alkuoletuksia. Jos ympäristöä voidaan simuloida, voidaan hyvyysfunktiot kehittää esim. laskemaan reitin pituutta tai reitin läheisyyttä esteisiin \cite{vadakkepat2002eapf}.

% Menetelmä toimii hyvin yksinkertaisissa ja avarissa ympäristöissä, mutta siinä on silti tiettyjä ongelmia, jotka on otettava huomioon ja joiden mukaan on jalostettava menetelmää hieman eteenpäin tilanteen mukaan \cite{ge2002new}. Lokaaleihin minimeihin voi jäädä loukkuun, lähekkäin olevien esteiden välistä ei pääse, kapeissa käytävissä syntyy helposti värähtelyä sekä määränpäähän voi olla mahdotonta päästä, jos sen toisella puolella on lähellä este. [REFACTOR]

Lokaalin minimin ongelmaan on esitetty useita samaan menetelmään integroitavia ratkaisuja. Lokaali minimi on paikallinen pieni potentiaalikuoppa, jonne jouduttuaan robotti ei pääse sieltä pois omin avuin tällä menetelmällä, koska siellä kaikki robottiin kohdistuvat voimat kumoavat toisensa ja se pysyy paikallaan. Yksi mahdollinen ratkaisu on poistumisvoima, joka otetaan käyttöön jos huomataan robotin olevan lähellä minimiä, esimerkiksi ennakkoon potentiaalikartasta tulkitsemalla \cite{vadakkepat2002eapf}. Tällöin kokonaisvoimaan lisätään esteiden hylkivää vaikutusta sopivaan suuntaan.

On myös ehdotettu robotin takana samaa rataa kulkevaa virtuaalista estettä, joka aiheuttaa voiman eteenpäin ja estää nollapotentiaalikuoppiin jumiutumisen \cite{thurau2004learning}. Tässäkin on ongelmana ko. voiman suuruuden optimointi: liian pieni voima on hyödytön ja liian suuri työntää robottia turhaan väärään suuntaan ja aiheuttaa hitautta ja voi estää kohteeseen pääsemisen luullen sitä lokaaliksi minimiksi.

Koska potentiaalikentät ovat hyvin universaali ja abstrakti ohjaustapa, niihin voidaan yhdistää muita menetelmiä rinnalle; kun huomataan, että minimikuoppa on lähistöllä, globaali reitinsuunnittelija voi aiemmin anturoidun ympäristön mukaan ohjata robottia toisen suuntaan virtuaalisella lisävoimalla tai jopa ohjata samaa polkua taaksepäin ja yrittää toista suuntaa esteiden ohi.


\subsection{Ohjauskulman huomiointi}

Muun muassa ohjauskulmakentäksi (steer angle field) \cite{feiten2002robust} ja kaarinopeusmetodiksi (curvature-velocity method) \cite{simmons2002curvature} kutsuttu menetelmä ottaa huomioon robotin kinematiikasta sen, että kaarella kulkevaan robottiin -- esim. differentiaaliajoa tai Ackermannin ohjausta (eli henkilöauton kinematiikkaa: kaksi kääntyvää pyörää neljästä) käyttävään -- ei välttämättä kannata kohdistaa kiihtyvyyttä kohtisuoraan kaarta vastaan jos haluaisi sen mahdollisimman äkkiä poispäin vieressä olevasta esteestä, koska robotti voi vain hetkellisesti kääntyä enemmän vasemmalle tai oikealle. Kyseessä ei sinänsä ole suoranaisesti esteenväistömenetelmä, vaan tapa kartoittaa reitit joita robotti ylipäätään voi kulkea.

Vastaava lähestymistapa on Foxin yms. \cite{fox2002dynwin} esittämässä dynaamisessa ikkunassa (dynamic window approach), joka painottuu robotin mahdollisten kiihtyvyyksien mukaan valittaviin suuntiin ja kaariin, jotka eivät törmää valitulla nopeudella mihinkään esteeseen. Kaarista valitaan erikseen soveltuvin polku, jota pitkin kuljetaan seuraavaksi. (Tähän tullee lisää tekstiä...)
% TODO

Kuvassa \ref{fig:ajolinjoi} esitetään eri kaaria, joita differentiaaliajoinen eli kahdella erikseen ohjattavalla renkaalla käänneltävä robotti pystyy kulkemaan, kun sillä on tietty vauhti josta ei ehditä jarruttaa tai kääntyä aivan toiseen suuntaan. Kaaria on periaatteessa ääretön määrä, joista kuvaan on yksinkertaistettu muutama. Tasaista vauhtia kulkemalla ko. robotti ajaa aina suoraan tai ympyrän kaarta pitkin. Suurempi nopeus myös rajoittaa kääntökulmaa, mikäli halutaan estää renkaiden lipsuminen [REF]: hitaammin ajamalla voi kääntyä tiukempia mutkia. Kuvan robotti ei esimerkiksi pysty lähtemään välittömästi suoraan vasemmalle.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.4\textwidth]{ajolinjoi}
\caption{Robotin ajolinjoja. Oikealle ei voi kääntyä lainkaan, koska esteeseen törmääminen olisi väistämätöntä. \label{fig:ajolinjoi}}
\end{figure}


\subsection{Varmuusruudukko}

Varmuusruudukko tai varausruudukko (certainty grid, occupancy grid) on yksi tapa esittää ympäristön esteet \cite{elfes2002occugrid} ja toimii monien muiden menetelmien pohjana. Sen ideana on nimensä mukaisesti rakentaa ruudukko robotin globaalista työavaruudesta, johon päivitetään anturien tietoa siitä, millä varmuudella ruudussa on este. Kun etäisyysanturi sanoo esteen olevan tietyllä etäisyydellä, voidaan tietyllä todennäköisyydellä sanoa, että siinä kohdassa on este, ja lisäksi robotin ja esteen välissä on tyhjää tilaa. Tällaista tietoa päivitetään robotin maailmankarttaan antureilta jatkuvasti.

Kun robotin havaitsema maailma diskretoidaan sopivan kokoisiin ruutuihin, voi sen jatkokäsittely yksinkertaistua algoritmista riippuen hyvinkin paljon \cite{elfes2002occugrid}. Kompromisseja tarkkuuden ja tehokkuuden välillä tehdään ruudun koossa: suurilla ruuduilla maailma approksimoituu vain muutamiksi ruuduiksi joiden läpikäynti on nopeaa, ja useammilla pienemmillä ruuduilla saadaan tarkkuutta laskentatehon kustannuksella. Ruudukko voidaan myös yhdistää globaaliin karttaan ympäristöstä, jolloin sen avulla voidaan estimoida paikkaa \cite{schiele1994comparison}.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.5\textwidth]{grid}
\caption{Esimerkki varmuusruudukosta aktiivisella ikkunalla.. \label{fig:certaintygrid}} % \cite{borenstein2002vfh}
\end{figure}

Kuvassa \ref{fig:certaintygrid} on kuviteltu esimerkkitilanne robotin ympäristön kuvaamisesta varmuusruudukossa. Vasempaan alanurkkaan on merkitty globaali koordinaatisto; ruudukko on aina samassa, etukäteen sovitussa asennossa esimerkiksi siten, että x-akseli osoittaa sinne minne robotti suuntasi alkuhetkellä. Tummemmat arvot ruuduissa kuvastavat varmempaa estettä eli sellaista, jossa ruutuun on osunut paljon mittauksia. Aktiivinen ikkuna -laatikko kuvaa ``ikkunaa'' koko ruudukkoalueesta johon tällä hetkellä kiinnitetään huomiota: robotin ei tarvitse ottaa huomioon koko varmuusarvoruudukon maailmaa vaan ainoastaan pieni alue robotin ympäriltä jonka sisältä laskettavat voimat ovat merkittäviä suunnan suhteen -- täten laskennan haastavuus ei kasva sitä mukaa kun saadaan lisää havaintoja ympäristöstä. Ikkuna on joka hetkellä robottikeskeinen (robottia kuvaa ympyrä ikkunan keskellä). \cite{elfes2002occugrid}

Menetelmä soveltuu erityisesti häiriöiseen ja epävarmaan mittaukseen esim. ultraääniantureille joihin liittyy lähes ominaisesti epävarmuutta, vahinkokaikuja ja vierekkäisten sensorien ristivaikutusta \cite{borenstein2002vfh}. Kun karttaa päivitetään jatkuvasti robotin edetessä, samoista esteistä saadaan useita pistemäisiä mittauksia samoihin ruutuihin ja varmempien ruutujen todennäköisyys kasvaa. % TODO: lisää. vanhentumista, todnäkkei.


\subsection{Histogrammit}

Borenstein ja Koren \cite{koren1991potential} toteavat potentiaalikentät riittämättömiksi ja esittävät niihin ja varmuusruudukkoon pohjautuvan virtuaalisen voimakentän (virtual force field, VFF) ja siitä edelleen kehittyneen vektorikenttähistogrammin (vector field histogram, VFH) \cite{borenstein2002vfh, borenstein2002realtime}.

Virtuaalinen voimakenttä perustuu Borensteinin ja Korenin työssä varmuusruudukkoon, jonka ruutuihin summataan arvoja robotin 24 ultraäänianturilta. Tästä ruudukosta otetaan tietyn kokoinen neliö robotin sijainnin kohdalta (kuten ikkuna kuvassa \ref{fig:certaintygrid}), jota päivitetään mittauksia saadessa ja josta lasketaan robotin suuntaa ja nopeutta ohjaava voima samankaltaisesti kun potentiaalikentissä: lähellä olevat esteet tuottavat voimakkaita hylkiviä voimia. Esteiksi lasketaan ruudut, joissa on mittauksia; mittausten määrä kuvaa esteen kokoa ja kompensoi täten myös epävarmuuksia ja häiriömittauksia. Hylkivät voimavektorit lasketaan seuraavasti \cite{koren1991potential}:

\begin{equation}
F_{i,j} = F_{r} C_{i,j} (\frac{W}{|c_{i,j} - r|})^n (c_{i,j} - r),
\end{equation}
missä $i$ ja $j$ ovat ruudun koordinaatit, $F_{i,j}$ ruudun muodostama voima, $F_r$ repulsiivisuusvakio, $C_{i,j}$ ruudun varmuusarvo, $W$ robotin leveys, $c_{i,j}$ ruudun paikkavektori ja $r$ robotin paikkavektori. $n$ on jokin kokonaisluku. Kohdepiste vetää robottia puoleensa seuraavasti voimalla $F_k$ kaavalla
\begin{equation}
F_{k} = F_{a} (k - r),
\end{equation}
missä $F_a$ on attraktiivisuusvakio, $k$ kohteen paikkavektori ja $r$ robotin paikkavektori. Robotin ohjauskulmaa säädetään seuraavasti:
\begin{equation}
\Omega = k (\delta - \theta),
\end{equation}
missä $\Omega$ on ohjaukselle syötettävä kääntönopeus, $k$ suhteuttamisvakio, $\delta$ kulma johon robottia ohjataan (saadaan voimavektorien summasta) ja $\theta$ nykyinen robotin ajokulma. Borenstein ja Koren toteavat tästä eteenpäin mm. ohjauksen epästabiilisuuden esteiden läheisyydessä \cite{koren1991potential}.

\begin{figure}[h!t!]
\centering \includegraphics[width=0.6\textwidth]{histopallo}
\caption{Karkea kaavakuva vektorikenttähistogrammin toiminnasta: ylempänä kartta ja esteet, alempana kartasta laskettu histogrammi. Kulma kasvaa ympyrässä vastapäivään ja histogrammissa oikealle. \label{fig:histogram}} % Borensteinin ja Korenin kuva histogrammeista. Ylempänä itse histogrammi eli estevarmuus kulman funktiona, alempana sama tulkittuna varmuusarvoruudukon päälle
\end{figure}

Borenstein ja Koren \cite{borenstein2002vfh} toteavat että suoraan kaksiulotteisesta kartasta voiman tulkitseminen menettää liikaa informaatiota, ja ottavat käyttöön toisen laskentavaiheen, histogrammitaulukon. Histogrammi kattaa täyden ympyrän robotin ympärillä, ja sen joka sektorille lasketaan asteittain varmuusarvoruudukon arvot niistä ruuduista, jotka kullekin sektoreille osuvat. Histogrammiin syntyy huippuja ja laaksoja. Laaksot ilmaisevat alueita, joita on turvallista lähestyä; korkeat huiput kuvaavat paikkoja, joissa on todennäköisesti jokin lähellä oleva tai suuri este, jota on väistettävä.

Varmuusruudukon arvoista lasketaan painotetut arvot riippuen siitä, kuinka suuri arvo ruudussa on ja kuinka kaukana se on robotista \cite{borenstein2002vfh}:
\begin{equation}
m_{i,j} = (c_{i,j})^2 (a - b*d_{i,j}).
\end{equation}
Kaavassa $i$ ja $j$ ovat ruudun koordinaatit, $m_{i,j}$ on uusi painotettu arvo, $c_{i,j}$ ruudun varmuusarvo, $a$ ja $b$ positiivisia skaalausvakioita ja $d_{i,j}$ etäisyys ruutuun robotin keskipisteestä. $a$ ja $b$ valitaan siten, että $m$:n arvoksi tulee 0 varmuusruudukon ikkunan kauimmaisessa ruudussa \cite{borenstein2002vfh}. Sektorin painoarvo $s_k$ lasketaan summana painotetuista ruutujen arvoista:
\begin{equation}
s_k = \sum_{i,j} m_{i,j},
\end{equation}
kun $i,j$ käyvät läpi ruudut, jotka osuvat sektorille $k$.

Histogrammiin jaettavan sektorin epäsuotuisuus lasketaan varmuusruudukon arvojen neliöistä, jolloin varmempia mittauksia painotetaan huomattavasti enemmän, ja pienet, häiriömäiset mittaukset jäävät lähes huomiotta. Verrannollisuus $-d$:hen aiheuttaa kauempana olevien esteiden painottamisen vähemmän kuin lähellä olevien.

Iso ruudukko tuo isoja vaihteluita diskreetin luonteensa takia, jolloin tarvitaan kokeellisesti viritettävä alipäästösuodin ettei ohjaukseen tulisi suuria yhtäkkisiä vaihteluita; lopulliset painoarvot $s'_k$ sektoreille lasketaan painotettuna keskiarvona kohdan $k$ ympäriltä \cite{borenstein2002vfh}. 

% (Potentiaalikenttien pahimmat ongelmat -- lokaali minimi ja värähtely kapeissa käytävissä -- vähenevät tai häviävät kokonaan kun tämä menetelmä ottaa päinvastaisen lähtökohdan ja etsii liikettä rajoittavien esteiden sijaan alueita, jonne saa liikkua eikä häiriinny pahasti reunoilla olevista esteistä.)

Kuvassa \ref{fig:histogram} havainnollistetaan karkeasti vektorikenttähistogrammin toiminta -- oikeassa tilanteessa segmenttejä olisi huomattavasti enemmän; kuvan ympyrä on jaettu 15 asteen segmentteihin hahmottamissyistä. Robotti sijaitsee pistemäisenä ympyrän keskellä, ja ympyrän eri segmenttien sisältämät estemäärät lasketaan yhteen. Histogrammiin muodostuu suuria arvoja niihin kohtiin, mitä vastaavissa suunnissa on suuria tai lähellä olevia esteitä. Reitti valitaan suuntaan, jossa on suurin tyhjä aukko histogrammissa eli jossa lienee varmimmin kuljettava reitti. Koska histogrammimenetelmä hakee esteiden sijaan parhaan suunnan johon voi ajaa, sillä ei ole lokaalin minimin ongelmaa \cite{borenstein2002vfh}.


% Tätä voitaisiin hieman korjata ottamalla huomioon robotin sijainti ruutunsa sisällä sen sijaan, että ainoastaan laskettaisiin vain näiden suurten (esim. 10*10 cm) ruutujen etäisyyksiä. Voitaisiin myös kompensoida ohjauksen vaihtelua lisäämällä algoritmiin heuristiikkaa esim. suoraan ajamisesta: jos turvallisen lähestymisen laakson suunta ei suuremmin eroa nykysuunnasta, ei suuntaa kannata merkittävästi vaihtaa. [TODO: pohdintoihin, siisti konditionaaleja]

\subsubsection{Parannuksia}

VFH ei ota huomioon robotin kinematiikkaa millään lailla, vaan olettaa että robotti on pistemäinen ja voi vaihtaa kulkusuuntaansa välittömästi. Borenstein ja Ulrich esittävät VFH+-algoritmin, joka korjaa tämän ongelman \cite{ulrich2002vfh+}. He tutkivat ihmisvoimin työnnettävää, differentiaaliajoa (kaksi erillistä vetävää pyörää) käyttävää robottia ohjaamaan sokkoa ihmistä. Tämä eroaa kinematiikaltaan oleellisesti aiemmin käytetystä, joka suuntaan ajavasta robotista.

VFH+ tuo seuraavat parannukset: Robotti oletetaan pistemäiseksi ja esteitä vastaavasti kasvatetaan robotin koon ja muodon tuomien rajoitteiden mukaan, jolloin alipäästösuodinta ei tarvita \cite{ulrich2002vfh+}. Histogrammikartasta tehdään ensin binäärinen kartta kahden kynnysarvon avulla. Tämän jälkeen karttaa laajennetaan edelleen poistamaan ne suunnat, joihin robotti ei ehdi kääntymään kinematiikkansa takia. Nämä lasketaan tässä tilanteessa kääntösäteen avulla. Lisäksi ohjaussuunnan valinnassa käytetään apuna hyvyysfunktiota, jolla voidaan painottaa erilaisia ominaisuuksia vapaista suunnista. Eri suuntia ovat eri kapeat käytävät, sekä leveistä käytävistä on valittava ajetaanko keskeltä vai reunoista, jos reuna olisi lähempänä kohdetta PLPLFKOFSDF TODO selkeämpi teksti. Borenstein ja Ulrich esittävät hyvyysfunktioksi seuraavaa:
\begin{equation}
g(c) = \mu_1 \delta(c, k_t) + \mu_2 \delta(c, \theta_i / \alpha) + \mu_3 \delta(c, k_{n, i-1})
\end{equation}

% TODO selvennä.

VFH+:sta vielä edelleen kehitetty VFH* \cite{ulrich2002vfhstar} käyttää A*-hakualgoritmia \cite{hart1968formal} etsimään optimaalisen valinnan saman laatuisista hetkellisistä ohjaussuunnista, ja näkee täten hieman kauemmas. VFH+ itsessään on täysin lokaali, ja saattaa väistää estettä umpikujaa päin, vaikka toiseen suuntaan väistäessä ei päädyttäisi umpikujaan; VFH* laskee reittiä joka kierroksella tietyn määrän askelia eteenpäin eri suuntakandidaateille ja evaluoi VFH+:ssa esitetyn hyvyysfunktion reitiltä, jolloin muodostuu askelmäärän syvyinen puu \cite{ulrich2002vfh+}. Puusta valitaan paras reitti hyvyysfunktion avulla, ja parhaaseen reittiin johtava suunta valitaan.

% tääkin varmuusruudukkoon? varmuusruudukko on abstraktiokerros blaa blaa
Algoritmin luonteeseen kuuluvan staattisen, jatkuvasti päivitettävän maailmankartan takia VFH ja sen johdannaiset soveltuvat sellaisenaan huonosti liikkuvien esteiden väistämiseen; eri hetkillä liikkuva esine havaitaan eri kohdissa, jolloin esine piirtää karttaan ``seinän'' reittinsä kohdalle. Varmemmilla sensoreilla voitaisiin laaja kartta unohtaa ja käyttää vain hetkittäisiä mittauksia histogrammin rakentamiseen. Näin liikkuvien esteiden vanhat sijainnit eivät vaikuttaisi.


%\subsection{Törmäyskeila}
% (Tämä osa vaatii selvennystä.) PALJON. TODO TODO.

%Chakravarthyn ja Ghosen \cite{chakravarthy2002cone} trigonometrinen törmäyskeilamenetelmä kuvaa hyvin abstraktilla tasolla, miten kaksi liikkuvaa pistettä, ympyrää tai lopulta mielivaltaisen muotoista kappaletta törmäävät. Pisteen ja toisen kappaleen välinen ``huono'' kulkualue muodostaa kolmion, jonka yhdessä kulmassa on piste ja toiset kulmat ovat kappaleen ulkoreunoilla siten, että koko kappale mahtuu näin muodostuvaan sektoriin. Menetelmä kertoo, missä kulmissa robotin keskipiste voi kulkea törmäämisen estämiseksi. Jos robotin suuntaa ajatellaan kolmion kärjestä lähtevänä nopeusvektorina, se ei saa olla sektorin sisällä. Väistösuunnan valinta on siis yksinkertaisesti nopeuden valinta sellaiseen suuntaan, joka ei osu keilan (tai keilojen, kun esteitä on useita) sisälle.

%Sellaisenaan menetelmä vaatii, että robotin ympäristön esteet tunnetaan kokonaisina kappaleina pistemäisten mittausten sijaan, ellei pistemäisiä mittauksia approksimoida jonkin kokoisiksi ympyröiksi. Lisäksi kappaleiden nopeudet on estimoitava pelkästään etäisyystiedon perusteella. Chakravarthy ja Ghose toisaalta esittävät samalla yksinkertaistavia approksimaatioita mielivaltaisen muotoisille kappaleille, jolloin voidaan käyttää pelkkiä ympyröitä ja laskenta helpottuu.



\subsection{Liikkuvat esteet}

Aiemmin esitellyt menetelmät soveltuvat liikkuvienkin esteiden väistämiseen, sillä niitä lasketaan jatkuvasti aina uudelleen uusista havainnoista. Kun esteiden sijainnit muuttuvat, myös esteenväistön tuottama ohjaus robotille muuttuu. Jos tiedetään ennalta esteiden sijaintien lisäksi niiden nopeudet, niin voidaan ennakoida koko ympäristön käyttäytymistä ja osittain kumota myöhemmin tapahtuvan liikettä monimutkaistavan esteenväistön tarvetta oikealla reitin valinnalla. Esimerkiksi risteystilanteessa omaa reittiä vasten kohtisuoraan sivusta tuleva este voi aiheuttaa jarruttamisen tarvetta mikäli robotti väistää sitä vasta lähelle päästyään. Ennakoiden voidaan kääntää reittiä siten, että ei nopeutta ei tarvitse vähentää ja päästään esteen edestä tai takaa siten, että törmäystä ei synny. [TODO: selvennä.]

\subsubsection{Havainnointi}

Riittävän tarkoista mittauksista voidaan estimoida perättäisten mittausten eroista ympäristön muutoksia, kun robotin nopeudesta tiedetään, millä lailla paikallaan seisovien esteiden havainnointi muuttuisi robotin liikkuessa. 

Prassler ym. \cite{prassler2002roboticswheelchair} käyttävät varausruudukon kaltaista aikaleimakarttaa havaintopisteiden varastoimiseen ja erottelevat siitä liikkuvat esteet paikallaan olevista tutkimalla kartan historiatietoa. Edellisten ajanhetkien ruudukoista etsitään ruudukon nykyhetken tiettyä mittaussolua vastaava solu, ja verrataan sen lähistöllä olevia mittauksia. Riittävän lähellä oleva mittaus lasketaan stationääriseksi; kaukana oleva taas on todennäköisimmin liikkuva kappale.

Riittää, että kartasta tunnistetaan liikkuvat esteet pistemäisinä; varausruudukon pisteet approksimoidaan tällöin ruudun kokoiseksi ympyräksi. Laskemista nopeuttaa, jos esteet tunnistetaan kokonaisina, sillä tällöin väistettäviä esteitä on vähemmän.

\subsubsection{Nopeuseste}

Chakravarthy ja Ghose \cite{chakravarthy2002cone} esittävät trigonometrisen törmäyskeilamenetelmän (collision cone) abstraktin muotoisten liikkuvien esteiden väistämiseksi. <BLA BLA> Menetelmä ottaa huomioon esteiden nopeudet ja muodostaa robotin ja esteiden nopeusvektorien keskinäisestä suhteesta ``keilan'', joka kuvaa mihin suuntaan liikkuminen aiheuttaa törmäyksen ja mihin suuntiin kulkemalla taataan turvallinen reitti.

Menetelmä ei ota kantaa esteiden havainnointitapaan vaan olettaa esteille tunnetut nopeudet, joista lasketaan suhteellinen nopeus itse robottiin nähden, oletetaan nopeudet vakioiksi ja lasketaan, millä robotin nopeusvektoreilla törmäys aiheutuisi johonkin aikaan tulevaisuudessa nykyhetkestä laskien. Robotti ei kuitenkaan kulje suoraa linjaa, eivätkä tosielämässä esteidenkään nopeudet ole välttämättä vakioita -- mallia lasketaan uudelleen tihein aikavälein, jolloin ennakoidaan esteen väistäminen hyvissä ajoin.

Yleisemmin tunnettu ja sovellettu, törmäyskeilaa vastaava Fiorinin ja Shillerin \cite{fiorini1998motion, fiorini2002motion} esittämä nopeusestemalli (velocity obstacle), myös suhteellisen nopeuden mallina (relative velocity approach) tunnettu, yksinkertaistaa robotin pisteeksi ja esteet ympyröiksi.

% Mallia käytetään yksinkertaistettuna pistemäiselle robotille ja ympyrän muotoisille esteille -- approksimoimalla molemmat ympyröiksi voidaan siirtää robotin oma koko esteisiin suurentamalla esteiden sädettä robotin säteellä [REF]. 

\begin{figure}[h!tb]
\centering \includegraphics[width=0.6\textwidth]{velobj}
\caption{Prasslerin ym. \cite{prassler2002roboticswheelchair} nopeusestekuva. Robotti on pisteessä $A$, estettä kuvaa ympyrä pisteessä $B$. Törmäyskeila $CC_{A,B}$ ja $B$:stä johtuva nopeuseste $VO_B$. \label{fig:velobj}}
\end{figure}

% TODO: symbolit!

Kuvassa \ref{fig:velobj} nopeusvektorit ($v_a$ robotin nopeus, $v_b$ esteen nopeus), törmäyskeila ja nopeuseste. Törmäyskeilaa rajaavat $B$:n $A$:n kautta piirretyt tangentit $\lambda_r$ ja $\lambda_t$; nopeusesteelle vastaavat reunat ovat $\delta_r$ ja $\delta_t$. Nopeusvektorin kärki ei saa olla esteen sisässä eli nopeusvektorista jatkettu suora $\lambda_{A,B}$ ei saa leikata esteympyrää, jottei törmäystä tapahtuisi jollain ajanhetkellä tulevaisuudessa. Törmäysvapaata suuntaa valittaessa on huomioitava myös robotin maksiminopeus; $v_a$:lla on jokin maksimipituus \cite{fiorini1998motion}. Nopeusvektori ei myöskään voi muuttua mielivaltaisen nopeasti johtuen robotin massasta ja maksimikiihtyvyydestä.

Matemaattisesti nopeuseste koostuu niiden nopeuksien joukosta robotille, joilla törmäys esteeseen tapahtuu jollakin tulevalla ajanhetkellä. Nopeuseste lasketaan Minkowskin summana törmäyskeilasta ja $v_b$:stä \cite{fiorini1998motion}. Geometrisesti ajateltuna törmäyskeilaa vain siirretään $v_b$:n verran. Formaalisti tämä määritellään seuraavasti:

\begin{equation}
\bigoplus
\end{equation}

Kun näin on saatu aikaan kartta hyväksyttävistä nopeuksista, valitaan niistä suosituin. On otettava huomioon, että vain nopeusvektorin lähistöllä olevat alueet ovat kelvollisia -- robotin massan ja sitä mukaa maksimikiihtyvyyden mukaan karttaan approksimoidaan monesti suorakaide nykyhetken nopeusvektorin pään ympärille \cite{fiorini1998motion, prassler2002roboticswheelchair, van2008reciprocal}. Fiorini ja Shiller \cite{fiorini1998motion} esittävät nopeuden valintaan heuristiikkoja: valitaan tilanteen mukaan suurin mahdollinen nopeus suoraan kohdetta päin, suurin nopeus joka saattaa erota hieman optimaalisesta suunnasta siten, että nopeus maksimoituu, tai nopeus jolla erityisesti kuljetaan esteen takaa. Toimintamalli valitaan tilannekohtaisesti ja se voi vaihdella prioriteettien mukaan.

Koska etäisyysanturoinnit ovat monesti pisteluonteisia, sopii ympyräapproksimaatio väistöön varsin hyvin; peräkkäiset pisteet tuottavat näin vastaavan estoliikkeen kuin kaikkien pisteiden muotoinen viiva tai suorakaide. [REF]

Fulgenzi ym. \cite{fulgenzi2007dynamic} simuloivat nopeusesteitä laajennettuna todennäköisyyksillä ja varausruudukolla ja huomioivat lisäksi epävarmojen ja tuntemattomien tilojen vaikutuksen: esimerkiksi nurkan taakse ei voi nähdä, jolloin nurkkaa lähestytään hitaalla nopeudella siten, että törmäys voidaan estää jarruttamalla mikäli liikkuva este yhtäkkiä havaitaan.

Van den Berg ym. \cite{van2008reciprocal} kehittivät nopeusesteitä edelleen pienin parannuksin ``keskinäisiksi'' nopeusesteiksi, ja lukuisilla kappaleilla simuloidut tulokset esittävät luotettavaa ja sileää käytöstä kun vastaavissa tilanteissa alkuperäinen nopeusestemenetelmä saa aikaan värähtelyä. Keskinäiset nopeusesteet olettavat, että muutkin liikkuvat esteet käyttäytyvät suurin piirtein samalla tavalla kohdatessaan esteen. Tällä tiedolla kompensoidaan ohjaus siten, että kaikkien robottien keskinäisten ohjausten tuloksena on jokaiselle törmäyksetön rata. Koska malli kuvaa läheisesti ihmisten liikettä, sillä saadaan robotti liikkumaan ihmisten lähistöllä sulavasti.



\subsection{Muuta}

Alunperin vihivaunut eli automaattitrukit käyttivät mekaanisia hätä-seis-kytkimiä huomaamaan törmäämiset [ref,ref]. Tällainen tunnistaminen ei kuitenkaan sovellu ennaltaehkäisevään esteenväistöön, sillä mekaanisen havaitsemisen yhteydessä esteeseen on jo törmätty. Esteenväistön rinnalla voidaan toisaalta käyttää hätä-seis-kytkimiä, jos ei voida olla varmoja siitä, voiko esim. kasvillisuuden läpi mennä vai tuleeko siellä vastaan huomaamaton este \cite{schafer20083d}.

Tietynlaista yleistä heuristiikkaakin on tutkittu mm. sumean logiikan avulla [ref]. Sumea logiikka käyttää hyväkseen ihmisille tuttuja ohjaussääntöjä: jos edessä vasemmalla näkyy este, renkaita ohjataan oikealle. Jos este on lähellä, hidastetaan vauhtia. jos este on hyvin lähellä, hidastetaan entistäkin kovempaa.


\clearpage
\section{Sovelluksia} % TODO: tms? aiemmin "laajempia tapoja"

[TODO: selitä mitä tässä sectiossa on tulossa, reffit kuntoon]

Edellä esiteltiin erilaisia puhtaan laskennallisia menetelmiä lokaaliin esteenväistöön. Näistä kaikki keskittyvät vain siihen, että edessä tai ympärillä on jokin tällä hetkellä tietyssä kohdassa oleva este reitin päällä, jolloin se on kierrettävä; tällaista tunnistusalgoritmia ajetaan jatkuvasti tiedoilla nykyhetkestä ja menneestä. Esitellyt algoritmit eivät ota kantaa maaston haastavuuteen, pinnanmuotoihin tai liikkuviin esteisiin.

Nykypintaan suhteessa hyvin vinoon mäkeen ei kannata lähteä kulkemaan, sillä robotti saattaa keikahtaa ympäri. Myös epätasaista maastoa kannattaa väistää, mikäli se on kierrettävissä tasaisen maaston kautta. Sama kannattaa tehdä upottavalle maastolle, jos tienpinnan pehmeys on havainnoitavissa.

Lisäksi reittiä voi dynaamisessa ympäristössä suunnitella korkeammalla abstraktiotasolla siten, että sensoridatasta tulkitaan edelleen erikseen paikallaan olevat ja liikkuvat hahmot. Liikkuvien hahmojen pohjalta suunnitellaan reitti kauemmas ja tarkemmin kuin hetkelliselle väistöliikkeelle: voidaan olettaa niiden kulkevan suoraa reittiä vielä hetken verran ja päätellä, kannattaako este kiertää takakautta odottamalla että se ajaa ohitse.


\subsection{Haastava ympäristö}

Sisätilat ja kaupunkimaastot ovat rakennettua ympäristöä, josta voi olettaa lukuisia yksinkertaistuksia. Rakentamaton maasto eli metsät, suot, muut kasvillisuudet ja kivikkoiset alueet ovat vaikeita, sillä maa ei ole tasainen eivätkä esteet ole korkeita tai kohtisuoria suhteessa maahan. Esteiksi on luokiteltava myös vaarallisen vinot mäet sekä kuopat. Kuoppia kutsutaan toisinaan negatiivisiksi esteiksi (negative obstacle). Tavallaan [TODO ??] aiempana esitettyjä väistömenetelmiä voidaan soveltaa varsin suoraan myös tällaiseen maastoon -- esteiden havainnointi ja tulkinta tosin eroaa oleellisesti rakennetun ympäristön havainnointitoiminnasta, mutteivät ne vaikuta itse väistämistoiminnon laskemiseen. Vino maasto tai syvät kuopat voidaan havainnoida konenäöllä ja merkitä edelleen varausruudukkoon väistettävinä kohteina. Maastosta voidaan kerätä lisäinformaatiota kuten pinnan epätasaisuutta, joka voidaan merkitä karttaan alueiden ominaisuutena joka syötetään reitinhaun hyvyysfunktiolle painokertoimena. [REF]

Schäferin ym. \cite{schafer2005stereo} nelipyöräinen robotti on varustettu stereonäöllä sekä kolmiulotteisella laserskannerilla, ja tuottaa ohjauksen käyttäytymispohjaisesti. Korkeisiin mäkiin ja hyvällä tiellä pysymiseen sekä esteiden väistöön varaudutaan erikseen; eri heuristiset käyttäytymismallit näille tuottavat vihjeitä etu- ja takarenkaiden kääntökulmalle ja nopeudelle. Mallit toimivat sumean logiikan kaltaisesti: jos oikealla näkyy este, pyritään kääntymään vasemmalle. Esteet (sekä hankalat maastot että konkreettisesti läpipääsemättömät kappaleet) havaitaan pääasiassa syvyysnäön epäjatkuvuuskohtien avulla maaston geometriasta.

Toisessa tutkimuksessa Schäfer ym. \cite{schafer20083d} tutkivat nimenomaan kasvillisuuspainotteista maastoa, jossa harvojen kasviesteiden tunnistaminen on haastavampaa. Tässä stereonäön ja laserskannauksen avuksi on liitetty kosketusanturi robotin eteen. Kun edessä huomataan harvaa ja mahdollisesti joustavaa kasvillisuutta, edetään silti eteenpäin mutta hidastetaan huomattavasti, jolloin kosketusanturi ehtii ilmoittaa turvallisesti mahdollisesta törmäyksestä kiinteään kappaleeseen kasvillisuuden sisällä. Jatkoa seuraa...

% Tässä yhteydessä on ulkotiloissa otettava huomioon maaston epätasaisuus, sillä muutoin oletetaan tutkan olevan saman suuntainen maatason kanssa ja vino maasto joka saa robotin kallistumaan tekee mittaukset hyödyttömiksi.


\subsection{Kokonaisia järjestelmiä} % TODO rename? konenäkömenetelmiä?

Stentz ja Hebert \cite{stentz1995complete} esittävät Humvee-ajoneuvoon asennetun, laserskannerilla havainnoivan ja gps:n ja odometrian yhdistelmällä paikkaa seuraavan järjestelmän. Järjestelmä yhdistää globaalin ja lokaalin navigoinnin. Se käyttää D*-algoritmia (kuten A* \cite{hart1968formal}, mutta tehokkuusparannuksilla dynaamiseen ympäristöön kun reittiä joudutaan laskemaan useasti) etsimään ennakkotietoon pohjautuvasta tiedosta optimaalisen globaalin reitin tavoitteeseen. Samalla sen lokaali navigointi antaa vihjeitä paikallisista esteistä laserskannauksen avulla. Globaalin ja lokaalin reitittäjän ohjaustulokista lasketaan painotettu keskiarvo siten, että lokaalia esteenväistöä painotetaan reitinhakua enemmän, jolloin pysytään reitillä mutta mennään esteiden ohitse \cite[s. 18]{stentz1995complete}.

Myös Kelly \cite{kelly1995intelligent} esittää tutkimuksessaan Humveehen kytketyn navigaattorin, joka ottaa ennustavasti huomioon useita eri uhkia joita valittavalla reitillä saattaa tulla vastaan \cite[s. 337]{kelly1995intelligent}. Algoritmi ottaa huomioon törmäysten ja tavoitteen haun lisäksi mm. liian suuren kääntökulman, jarrutustehon ja muut kinematiikasta aiheutuvat rajoitteet kaarinopeusmetodin lailla.

Koska edellä mainituissa on kyseessä ``tavallinen'' auto, algoritmi ehdottaa suoraa vauhtia sekä eturenkaille tiettyä kääntökulmaa, jota ennustetaan tietty lyhyt matka eteenpäin \cite[s. 45]{kelly1995intelligent}. Eri kääntökulmista seuraavat polut tutkitaan kartasta, ja näille lasketaan haastavuusarvot uhkista kulmapohjaiseksi histogrammiksi VFH+:n lailla. Histogrammit summataan yhteen jolloin paras yhteinen hyvyysarvo valitsee suuntakulman. Kelly väittää menetelmän toimivan 15 km/h vauhdissa \cite[s. 335]{kelly1995intelligent}.

Antureina tässä ajoneuvossa on laseretäisyysanturi ja stereokamera. Näiden tuottamista informaatiosta Kellyn algoritmi etsii adaptiivisesti jyrkkiä reunoja, joiden ympäristöä tarkastellaan maanpinnan vaihteluiden varalta pysyäkseen tasaisella maalla \cite[s. 211]{kelly1995intelligent}.

Aiempia vastaavalla tavalla toimii myös Singhin ym. \cite{singh2002recent} kuvaama navigointi, joka yhdistää lokaalin ja globaalin liikkeensuunnittelun. Globaalisti käytetään D*:ä kuten aiemmin. Lokaali suunnittelija perustuu Kellyn tutkimukseen ja arvioi lähiympäristön kaaren muotoisten reittien kustannuksia. Suunnittelija ottaa lisäksi huomioon ympäristön epävarmuuden; kartan pisteillä on varmuusarvoja, jotka vanhenevat robotin liikkuessa suhteessa matkan pituuteen, ja samalla uusille mittauksille alustetaan varmempi arvo. Varmuusruudukon arvot siis ``unohtuvat'' ajan kuluessa.

Michels ym. \cite{michels2005high} käyttävät vahvistusoppimista yhden kameran konenäöllä. Järjestelmälle opetetaan ennalta kamerakuvien ja laserskannerilla mitattujen etäisyyksien korrelaatiota, minkä jälkeen kauko-ohjattava auto väistää esteitä pelkän kameran avulla. Vahvistusoppimisessa algoritmi saa ``palkkion'' tekemänsä toiminnon mukaan ja korjautuu täten adaptiivisesti paremmaksi. Michelsin ym. algoritmi saa palkkiota siitä, että se pitää oikean nopeuden ja on törmäämättä esteisiin.

Anturien yhdistelyä jotenkin 


%\subsection{Neuroverkot}

%Neuroverkot perustuvat ihmisten aivojen imitoimiseen ja koostuvat tietystä määrästä sisään- ja ulostuloneuroneja sekä välissä olevasta kerroksesta, joka voi sisältää mielivaltaisen määrän neuroneja päättelyjen tekemiseen. Tapa on puhtaan matemaattinen ja toimii matalalla tasolla: neuroni saa syötteeksi lukuja, ja mikäli niistä laskettu painotettu summa ylittää raja-arvon, neuroni antaa ulostuloksi esimerkiksi luvun 1, muutoin luvun 0.

%Neuroverkkoja on sovellettu sekä liikkuville roboteille että manipulaattoreille \cite{glasius1995neural}. Tapa ei ole erityisen nopea ja vaatii verkon ennalta opettamisen, jotta tietty syöte tuottaisi oikeanlaisen vasteen. Toisaalta on saatu myös reaaliaikaiseen laskemiseen kykeneviä tuloksia dynaamisessa ympäristössä \cite{yang2000neural}.

%Myös täysin toisenlaista lähtökohtaa on ehdotettu robotin reitillä pysymiseen; Pomerleaun neuroverkolla toimiva konenäköjärjestelmä seuraa autotietä syöttämällä kuvan yläreunan pisteet verkolle, joka antaa vasteena hyvyysarvon eri suuntiin kääntymiselle \cite{pomerleau1989alvinn}. Tämä tapa ei väistä itse esteitä mitenkään. Tämä tekniikka saattaa olla hieman yliampuva tähän tarkoitukseen -- yhtä hyvin voitaisiin jaotella kuvan ylälaita kolmeen osaan, josta keskimmäinen kuvaa tietä, ja tästä tutkittaisiin kuinka lähellä kuvan keskiosaa tie kulkee.

% nää ei sovellu lokaaliin ollenkaan
%\subsection{Geneettiset algoritmit}

%Geneettinen algoritmi (GA) toimii intuitiivisesti ja luonnonmukaisesti evoluution lailla arpomalla alkupopulaation josta kehitetään eteenpäin uusia mutaatiolla ja risteyttämällä. Uusien ehdokkaiden hakua iteroidaan, kunnes erityisen hyvyysfunktion arvo on riittävä. Tämäkin on abstrakti ja matalan matemaattinen menetelmä, ja esimeriksi mutatointi onnistuu oikein valitulla mallilla aina vaihtamalla satunnaisesti jonkun populaation ``kromosomin'' lukuarvo toiseksi riippumatta siitä, mitä luvut esittävät.

%Tässä yhteydessä populaatio on lista solmupisteistä kartalla, joiden kautta reitti kulkee haluttuun kohteeseen. Hyvyysfunktio tuottaa hyviä arvoja lyhyistä ja mutkattomista reiteistä, ja erityisen suuria, varmasti hylättäviä ratkaisuja toteuttamiskelvottomista reiteistä jotka kulkevat esteiden lävitse \cite{nearchou1998pathgene}. Solmupisteet voidaan valita kartalta mistä tahansa pisteistä, tai valintaa voidaan yksinkertaistaa muodostamalla kartasta ruudukko (sopii yhteen hyvin mm. varmuusruudukkoon) jonka jokainen ruutu on mahdollinen solmukohta \cite{hu2004knowgene} \cite{sugihara2002genetic}.

%Geneettiset algoritmit tuottavat aina kelvollisia polkuja, ja hyvyysfunktion valinnalla sekä algoritmin sisäisen toiminnan optimoinnilla, eli sillä kuinka solmupistereitti kuvataan populaationa, voidaan algoritmista saada tarkka ja nopeahko. Suurella kartalla GA:n iterointi voi silti kestää liian pitkään jotta sitä voisi käyttää reaaliajassa. Toinen ongelma on vaatimus kartasta: algoritmi on muihin verrattuna raskas ja liian monipuolinen erittäin paikalliseen reitinsuunnitteluun, ja globaaliin suunnitteluun se taas vaatii karttaa pidemmälle kuin mitä antureilla voidaan saada, eikä siis sovellu kovin hyvin paikalliseen esteenväistöön.


\clearpage
\section{Yhteenveto ja pohdintaa}

Lähes kaikki robottien lähialueen liikkeensuunnittelualgoritmit pohjautuvat jossain määrin samoihin, monesti tutkittuihin vanhoihin aiheisiin. Esteenväistöalgoritmin valinnassa ja optimoinnissa tulee kiinnittää huomiota erityisesti robotin kinematiikkaan ja ympäristöön jossa se tulee liikkumaan. Sisätiloissa ultraäänianturit ja vektorikenttähistogrammi (tai sen johdannaiset) riittävät hyvin, kunhan histogrammin kartta kattaa vain lähialueen eikä koko ``maailmaa'' mikäli tilassa on useita liikkuvia ihmisiä ellei kartan varmuusarvoja vanhenneta. Liikkuvat esteet voidaan tunnistaa etsimällä perättäisistä mittauksista vastaavat pisteet ja tutkimalla niiden liikkumisnopeuksia.

Erilaisista mahdollisista reiteistä voidaan valita suosituin eri kriteereillä VFH+:n käyttämän hyvyysfunktion lailla. Aina ei välttämättä kannata ajaa suoraan tavoitepistettä kohti, jos toinen reitti minimoisi jarruttelun, liikkuvien esteiden läheltä kulkemisen, maaston haastavuuden tai muun reitin lyhyyden sijaan optimoitavan kriteerin.

Liikkuvat kappaleet tuskin koskaan ovat vain yhden mittauspisteen kokoisia, jolloin lähekkäisiä pisteitä voidaan yhdistää vertaamalla niiden keskinäisiä nopeuksia: suunnilleen saman nopeuksiset pisteet luultavasti kuuluvat samaan kappaleeseen. Tästä voidaan estimoida keskikohta massakeskipisteen avulla. Täten väistämisen suhteen tutkittavia esteitä on vähemmän.

Liikkuviin esteisiin tulee kiinnittää huomiota pääasiassa kahdella eri tavalla: ensinnäkin liikkumaan kykenevän esteen ei voi olettaa olevan samassa kohdassa, mikäli kohtaan palataan myöhemmin -- jos jonkinlaista karttaa rakennetaan, on sensoreilta saataville karttapisteille hahmoteltava varmuusluvut jotka ikääntyvät pikkuhiljaa, jolloin epävarmat esteet unohdetaan eikä niiden pohjalta voi pitkän ajan päästä suunnitella reittiä. Toisekseen, jos robotilla on erityinen kiire tai jos haetaan esim. ihmisten lähellä hyvin toimivaa käyttäytymistä, voidaan tunnistaa liikkuvat objektit jo havainnointivaiheessa ja esim. risteystilanteessa odottaa hetki, että nopeampi sivulta päin tuleva este menisi ohi.

Ulkotiloissa järkevä anturointi on kolmiulotteinen laserskannaus yhdistettynä yhteen tai useampaan kameraan. Ulkona liikkuvat robotit ovat helposti auton mallisia ja ajavat mahdollisesti kovaa vauhtia ympyrän kaaren mallisilla radoilla, eivätkä potentiaalikenttiin perustuvat tavat välttämättä ole tarpeeksi nopeita: varsinkin kaupunkiolosuhteissa esteitä havainnoidaan yleensä vain edestä ja niitä väistetään vasemmalle tai oikealle sekä mahdollisesti jarruttamalla. Tällöin lokaali esteenväistö muodostuu edessä olevien hahmojen havaitsemisesta ja robotin (usein auton) ohjaamisesta vasempaan tai oikeaan esteen ohitse nopeusestemenetelmällä ja renkaiden rajat huomioiden kaarinopeusmetodilla.

Jos tiedetään ennalta millaiseen ympäristöön robotti viedään, voidaan tehdä yksinkertaistavia heuristiikkoja anturidatalle sekä esteille. Henkilöautoa automatisoidessa voidaan hyvin suurella todennäköisyydellä olettaa, että se ajaa autoteillä ja siten etsiä maanpinnasta kaistaviivoja (jolloin ohjaus ei tosin toimi lumella) sekä kiinnittää huomiota ennalta mm. risteystilanteisiin ja kaistanvaihtoihin. Kävelytiellä kulkeva robotti taas voisi yrittää etsiä talon seinää vierestä, joka auttaisi kulkemaan suoraan. Haastavassa maastossa on muistettava maaston kuopat ja vinot mäet sekä kasvillisuus jonka läpi saattaa kyetä ajamaan vaikka kasvit olisivatkin korkeita.

Lisää...

Universaalia aivan kaikkialle sopivaa lokaalia esteenväistöä ja/tai liikkeensuunnittelua ei ole, koska mahdollinen työalue voi olla mitä vain tehdastiloista kaupunkimaastoon. On tosin useita yleisiä sovellettavia menetelmiä ja tilannekohtaisia heuristiikkoja. Myös monista tavoista yhdistelemällä voidaan saada kehittyneempiä tapoja kartoittamalla kaikkien heikkoudet ja soveltamalla tiettyyn ympäristöön. Monia tutkimuksia on testattu käytännössä, toisia simuloimalla ja jotkut ovat jääneet vain teoreettisiksi pohdinnoiksi ja kaavoiksi. 


\clearpage
\addcontentsline{toc}{section}{Viitteet}
\bibliography{kandi}


\end{document}
