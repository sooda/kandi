\documentclass[finnish,12pt]{article}
\usepackage{aaltothesis}
\usepackage{natbib}
\bibliographystyle{unsrt} % plain} % finplain

% \usepackage[utf8]{inputenc}

%% Kyt seuraavaa latex-komennon ja eps-kuvien kanssa 
%\usepackage[dvips]{graphicx}

%% Jos ts kytt pdflatex-komentoa, 
%% joka knt tekstin suoraan pdf-tiedostoksi ja kuvasi
%% ovat esim. jpg-formaatissa tai pdf-formaatissa,   
%% kytetn seuraavaa pakettia, kommentoi siis kommenttimerkki pois
%% Huom! Tekstin marginaalit saattavat poiketa n. 2-5 mm
%% suosituksesta, jos kytt pdflatex-komentoa!
\usepackage[pdftex]{graphicx} 

%% Saat pdf-tiedoston viittaukset ja linkit kuntoon seuraavalla paketilla.
%% Paketti toimii erityisen hyvin pdflatexin kanssa. 
%%
%% Use this if you want to get links and nice output with pdflatex
\usepackage[pdfpagemode=None,colorlinks=true,urlcolor=red,%
linkcolor=blue,citecolor=black,pdfstartview=FitH]{hyperref}

%% Jos et jostain syyst tykk kytt
%% edellist hyperref pakettia, voit kytt mys seuraavaa pakettia
%% (tarvitaan lhinn url-komennon mrittmiseen ja formatoimiseen)
%%
%% Use this if you do not like hyperref package - this
%% defines url environment and formats it correctly

% \usepackage{url}
%% Matematiikan fontteja, symboleja ja muotoiluja lis, nit tarvitaan usein 
%%
%% Use this if you write hard core mathematics, these are usually needed
\usepackage{amsfonts,amssymb,amsbsy}  
\usepackage{amsmath}
%% Vaakasuunnan mitat, L KOSKE!
\setlength{\hoffset}{-1in}
\setlength{\oddsidemargin}{35mm}
\setlength{\evensidemargin}{25mm}
\setlength{\textwidth}{15cm}
%% Pystysuunnan mitat, L KOSKE!
\setlength{\voffset}{-1in}
\setlength{\headsep}{7mm}
\setlength{\headheight}{1em}
\setlength{\topmargin}{25mm-\headheight-\headsep}
\setlength{\textheight}{23cm}


%% Kaikki mik paperille tulostuu, on tmn jlkeen
%%
%% Output starts here
\begin{document}

%% Korjaa vastaamaan korkeakouluasi
%%
%% Change the school field to describe your school 
\university{aalto university}{Aalto-yliopisto}
\school{School of science and technology}{Teknillinen korkeakoulu}

%% Korjaa seuraavat vastaamaan omaa tiedekuntaasi
%%
%% Change the faculty field to describe your faculty
\faculty{Faculty of Electronics, Communications and Automation}%
{Elektroniikan, tietoliikenteen ja automaation tiedekunta}%
%%

%% Vain kanditylle: Korjaa seuraavat vastaamaan tutkinto-ohjelmaasi
%%
%% Only for B.Sc. thesis: Choose your degree programme. 
\degreeprogram{Automation and control engineering}%
{Automaatio- ja säätötekniikka}
%%

%% Vain DI/M.Sc.- ja lisensiaatintylle: valitse laitos, 
%% professuuri ja sen professuurikoodi. 
%%
%% Only for M.Sc. and Licentiate thesis: Choose your department,
%% professorship and professorship code. 
%\department{Department of Radio Science and Technology}%
%{Radiotieteen ja -tekniikan laitos}
%\professorship{Circuit theory}{Piiriteoria}
%\code{S-55}
%%

%% Valitse yksi nist kolmesta
%%
%% Choose one of these:
\univdegree{BSc}
%\univdegree{MSc}
%\univdegree{Lic}

\author{Konsta Hölttä}

%% älä tavuta otsikkoa ja
%% Muista ett otsikkoja ei tavuteta! 
%% Jos otsikossa on ja-sana, se ei jää rivin viimeiseksi sanaksi 
%% vaan aloittaa uuden rivin.
\thesistitle{}{Liikkuvien robottien paikallinen esteenväistö ja liikkeensuunnittelu}

\place{Espoo}
%% Kandidaatintyn pivmr on sen esityspivmr! 
\date{x.y.2010}

%% Kandidaattiseminaarin vastuuopettaja tai diplomityn valvoja.
%% Huomaa titteliss "\" -merkki pisteen jlkeen, 
%% ennen vlilynti ja seuraavaa merkkijonoa. 
%% Nin tehdn, koska kyseess ei ole lauseen loppu, jonka jlkeen tulee 
%% hieman pidempi vli vaan halutaan tavallinen vli.
\supervisor{D.Sc.\ Ilkka Seilonen}{TkT Ilkka Seilonen}

%% Kandidaatintyn ohjaaja(t) tai diplomityn ohjaaja(t)
\instructor{D.Sc.\ (Tech.) Jari Saarinen}{TkT Jari Saarinen}
%\instructor{M.Sc.\ (Tech.) Polli Pohjaaja}{DI Polli Pohjaaja}

%% Aaltologo: syntaksi: \uselogo{red|blue|yellow}{?|!|''}
\uselogo{red}{''}{tkk}
\makecoverpage

\keywords{liikkuva robotti, paikannus, lokaali liikkeensuunnittelu, esteenväistö, dynaaminen ympäristö}

\begin{abstractpage}[finnish]
Liikkuviin robotteihin ja niihin liittyvään esteenväistöön kuuluu laaja-alaisuutensa takia suuri joukko asioita esteiden havainnoinnista sopivan reitin ennustukseen. Tässä työssä kartoitetaan reaaliaikaisia menetelmiä liikkuvien robottien lähellä olevien esteiden kiertämiseen ja tästä aiheutuvaan lyhyen kantaman liikkeensuunnitteluun.

Pääpaino on ympäristöllä, josta ei juurikaan tiedetä mitään etukäteen; on myös todennäköistä joutua väistämään liikkuviakin esteitä. Pohditaan esteentunnistustapojen ja robotin ohjaustapojen soveltuvuutta eri ympäristöihin siten, että päästään määränpäähän mahdollisimman optimaalisella tavalla osumatta reitillä oleviin maaston haastavuuksiin ja stationaarisiin ja liikkuviin esteisiin.

Samalla sivutaan myös aiheeseen liittyviä peruskäsitteitä ja yleisiä ongelmia, joita esteenväistössä on otettava huomioon: eritellään menetelmien mukana erilaisten ympäristön havainnointitekniikoiden robustisuutta robotin esteiden ja maaston ``näkemiseen'' ja robotin itsensä paikan sekä reitin seuraamiseen. Luodaan katsaus myös aiheen kokonaiskuvaan pohtien käyttökelpoisuutta eri näkökulmista.
\end{abstractpage}

\newpage

\mysection{Esipuhe}
Tähän ei mitään tarvinne...

Joka kappaleeseen lisättäneen vielä tarkennuksia johonkin suuntaan kunhan ajatukset selvenee. Etenkin loppupuoliskoon.

\vspace{5cm}
Otaniemi, x.y.2010

\vspace{5mm}
{\hfill Konsta Hölttä \hspace{1cm}}

\newpage


%% Sisllysluettelo
%% addcontentsline tekee pdf-tiedostoon viitteen sisllysluetteloa varten
\addcontentsline{toc}{section}{Sisällysluettelo}
\tableofcontents

%\mysection{Symbolit ja lyhenteet}

%\subsection*{Lyhenteet}

%\begin{tabular}{ll}
%VFH &	vector field histogram \\
%DWA &	dynamic window approach \\
%AGV &	automated guided vehicle \\
%RRT &	rapidly-exploring random tree \\
%SLAM &	simultaneous localization and map building \\
%SIFT &	scale-invariant feature transform
%\end{tabular}


%% Sivulaskurin viilausta opinnytteen vaatimusten mukaan:
\cleardoublepage
\storeinipagenumber
\pagenumbering{arabic}
\setcounter{page}{1}



\section{Johdanto}

Referenssejä!

\thispagestyle{empty}

Esteenväistö ja liikkeensuunnittelu ovat klassisia ongelmia joihin on oleellisesti kiinnitettävä huomiota aina itsenäisesti liikkuvaa robottia suunnitellessa. Robotin on osattava navigoida itsenäisesti ja sen on päästävä perille nopeasti vahingoittamatta itseään tai ympäristöään. Robotilla on tietty konfiguraatioavaruus (configuration space), eli joukko mahdollisista sijaintien, asentojen ja nopeuksien yhdistelmistä. Lokaaliin anturipohjaiseen esteenväistöön on luonnollisesti monia eri menetelmiä, joiden hyödyllisyys ja soveltuvuus riippuu robotin ympäristöstä ja anturien laadusta. Universaalia kaikkialle sopivaa lokaalia esteenväistöä ja/tai liikkeensuunnittelua ei ole [REF: joku survey]. On tosin useita yleisiä sovellettavia menetelmiä ja tilannekohtaista heuristiikkaa. Myös monista tavoista yhdistelemällä voidaan saada kehittyneempiä tapoja kartoittamalla kaikkien heikkoudet ja soveltamalla tiettyyn ympäristöön. Monia tutkimuksia on testattu käytännössä, toisia simuloimalla ja jotkut ovat jääneet vain teoreettisiksi pohdinnoiksi ja kaavoiksi.

Ympäristöä havainnoidaan jatkuvasti robotin antureilla, ja kun esteitä aistitaan, pyritään laskemaan väistämissuunnitelma mahdollisimman nopeasti. Jotkin väistötavat liittyvät tiettyihin antureihin ja reaaliaikaisuuteen, ja anturien hyvät ja huonot puolet on muutenkin otettava huomioon mm. havaitsemisetäisyyden, kohinan ja epävarmuuksien takia. Yleisiä havainnointimenetelmiä ovat ultraääni- ja infrapuna-anturit, laserskannerit ja videokamerat. Hyvillä menetelmillä anturointi onnistuu jatkuvasti; toisilla robotti joutuu välillä pysähtymään mittauksia varten. Pyritään siihen, että robotti voi ajaa jatkuvasti pysähtymättä.

Esteiden ohi selviämisen lisäksi robotin on pysyttävä reitillään ja sen on jotenkin saatava tietoa sijainnistaan ja suunnastaan, mikäli tavoitteena on päästä tavoitepisteeseen eikä harhailla sokeasti. Tämänkin toteutus riippuu robotin sijaintiantureista ja niiden sopivuudesta ympäristöön. Yleisimmin käytettyjä tapoja paikannukseen ovat odometria, maamerkit, gps, radiomajakat ja näkyvien maanmuotojen vertaaminen karttaan. Kaikki tavat ovat jossain määrin epätarkkoja, joten virhearviot on otettava huomioon ja mielellään käytettävä montaa tapaa rinnakkain. Kalman-suodin onkin suosittu apu reitin ja sijainnin tarkastelun yhteydessä.

Tässä työssä kartoitetaan yleisellä tasolla eri esteenväistömenetelmiä ulkotiloissa maanpinnalla liikkuville roboteille. Kiinnitetään erityisesti huomiota vaihtelevassa ja dynaamisessa ympäristössä kulkeviin robotteihin. Tässä yhteydessä dynaamisella ympäristöllä tarkoitetaan sellaista, jossa esteet ovat vaihtelevia ja voivat liikkua, ja robotilla jotakin itsenäisesti liikkuvaa ajoneuvoa, kuten vihivaunua tai automaattisesti ajavaa henkilöautoa. Kiinteästi asennettavia robotteja kuten manipulaattorikäsivarsia ei käsitellä.

Työssä sivutaan myös globaalia liikkeensuunnittelua, eli tilannetta jossa kartta josta reitti suunnitellaan on tiedossa etukäteen. Painopiste on kuitenkin yhtäkkisten, odottamattomien esteiden havaitsemisessa ja väistämisessä kun jonkinlainen tavoitepiste on tiedossa ennalta. Reitin ja ympäristön muutoksia voidaan myös päivittää robotille reaaliajassa ylemmältä taholta. Aina ei kuitenkaan voida saada ennakkotietoa alueista, joissa robotti kulkee; tällöin alueet on kartoitettava matkan varrella. Globaalin reitin suunnittelu oletetaan hoidetuksi; ei oteta kantaa, tuleeko reitti jostain ylempää vai lasketaanko sitäkin reaaliajassa robotilla.


\clearpage

\section{Lokaalin esteenväistön ongelma}

Robotin paikallisen navigoinnin pohjalla on hyvin paljon muitakin väistöalgoritmeihin liittymättömiä ongelmia, joita tässä tekstissä sivutaan vain sen verran kuin on välttämättä tarpeen. Seuraavassa esitellään pohjustukseksi joitain perusasioita pyörillä kulkevan robotin liikkumisesta, joihin kaikki myöhemmin esitettävä teksti pohjautuu.

\subsection{Mekaniikka}

Tässä työssä robotti on jokin autonomisesti liikkuva väline jolla on tietty määränpää. Ympäristö jossa robotti ajaa määrää pitkälti robotin mekaanisen rakenteen: esimerkiksi pyöreäalustainen joka suuntaan kääntyvä ajoneuvo, henkilöauto, perävaunu tai metsäkone. Ympäristö ja rakenne puolestaan määräävät, miten robottiin voi kiinnittää anturit havainnoimaan ympäristöä. Nämä kaikki yhdessä tuovat rajoitteet, joiden perusteella lokaali liikkeensuunnittelu ratkaistaan.

Pyörät ovat yksinkertaisen mutta toimivan tekniikkansa vuoksi ylivoimaisesti useimpien nykyrobottien liikkumisen perustana \cite{siegwart2004introduction}. Haastavassa maastossa käytetään jotain pyöristä jalostettua tapaa, kuten telaketjuja tai renkaita, joihin on kiinnitetty piikkejä tms. \cite{abad2009axelwheel} \cite{saranli2001rhex}. Rakenteen puolesta (mm. renkaiden lukumäärä ja kääntymistapa) pyörillä liikkumiseenkin on hyvin monia tapoja, joissa on kaikissa omat hyvät ja huonot puolensa. Tapoja rajoittaa enimmäkseen robotin muoto ja kohdeympäristö; jotkut anturoinnit ja väistöalgoritmit soveltuvat vain tietynlaisille kinematiikoille eli robotin rakenteelle. Erityisesti joka suuntaan ohjautuvan robotin (omnidirectional robot) käsittely eroaa merkittävästi perinteisen auton kaltaisesta kulkuvälineestä [REF].

Nivelletyillä jaloilla käveleviä robotteja tutkitaan nykyään yhä enemmän. Humanoidirobotit soveltuvat ihmisille tarkoitettuun ympäristöön, ja näyttäisivät ihmisille luontevilta jolloin kanssakäyminen olisi helppoa ja ne voisivat hoitaa ihmisten tehtäviä [ASIMOV]. Nivelletyt jalat saattavat sopia haastavaan, epätasaiseen maastoon pyöreitä renkaita paremmin. Tätä on kokeiltu esimeriksi metsäkoneissa \cite{billingsley2008robotics}.

Itse esteiden väistämisen aiheuttaman reitin lokaali suunnittelu on puhtaan laskennallista, mutta pohjalla on kuitenkin oikea ulkomaailma epätarkkuuksineen ja anturivirheineen. Jotkin menetelmät perustuvat hyvinkin vahvasti tietynlaiseen anturointitapaan, kuten siihen, että ultraääneltä saadaan suhteellisen epävarmoja mittauksia \cite{borenstein1988obstacleus}. Virheet ja epävarmuudet on pidettävä aina mielessä.


\subsection{Paikannus ja anturointi}

Olennainen ongelma liikkuville roboteille on itsensä paikannus \cite{borenstein1996whereami}. Kun robotin oletetaan tietävän kohdepiste tarkasti, pitää myös tietää missä itse robotti sijaitsee. Tähän voidaan käyttää tapauksesta riippuen esim. odometriaa \cite{borenstein1001umbmark}, inertiasuunnistusta \cite{barshan1995inertial}, radiomajakoita \cite{borenstein1997postech} tai maamerkkejä (kamerakuvalla tai maanpinnasta ``kosketuksella'' havaittavia) \cite{betke2002mobilelandmarks} \cite{desouza2002vision}. Maamerkkejä kannattaa suhteuttaa myös ennalta tunnettuun karttaan, mikäli sellainen on saatavilla \cite{leonard199geombeac}. Sensorifuusiota Kalman-suotimella voidaan myös hyödyntää, jolloin saadaan tarkempi tulos monen anturin yhdistetystä mittauksesta \cite{jetto2002kalman}. Usein uutta karttatietoa kerätään samalla kun antureilta saadaan dataa (simultaneous localization and mapping, SLAM) \cite{se2002mobilelocalization} \cite{wang2003online}.

Esteet on havainnoitava robotin lähistöltä jollain lailla. Infrapunaheijastuksiin ja ultraäänikaikuun perustuvat sensorit ovat yksinkertaisuutensa ja edullisuutensa ansiosta hyvin yleisesti käytettyjä, mutta myös häiriöalttiita ja epävarmoja \cite{benet2002usinginfrared} \cite{borenstein1988obstacleus}. Ne toimivat tutkamaisesti lähettämällä signaalin ja seuraamalla kaikua esteestä, johon siten arvioidaan etäisyys kaiun matkaan kuluneen ajan perusteella. Näitä antureita on tyypillisesti useita robotin ympärillä osoittamassa eri suuntiin.

Laserskannerit ja kamerat ovat tarkkoja ja näkevät kauas: niitä käytetään monesti ulkotiloissa \cite{bonin2008visual}. Kaksiulotteinen laserskanneri on myös tutkamainen ja useimmiten pyörii paikallaan automaattisesti tutkaten joka suuntaa; kolmiulotteinen laserskanneri kuvaa eteenpäin kahdella akselilla ja tuottaa syvyyskuvan [TODO: selvennä] \cite{guivant2000localization} \cite{surmann2003autonomous}. Vielä tarkempaa kuvaa saadaan videokameroilla, joiden kanssa tarvitaan laskentatehoakin huomattavasti edellä mainittuja enemmän. Konenäkö on ylivoimainen, kun tarvitaan tarkempaa tietoa edessä olevista pinnoista, kuten kuviointia tai asentoa. Kahdella oikein sijoitellulla kameralla saadaan aikaan syvyysnäkö \cite{murray2002stereo}.


\subsection{Lokaali esteenväistö}

Tästä eteenpäin oletetaan, että esteet ja lähiympäristö sekä robotin sijainti on havaittu jollain menetelmällä, ja tietyllä varmuudella tiedetään ympäristön muoto ja mahdollisesti reitillä olevat esteet -- havainnointimenetelmään sen enempää ottamatta kantaa mitä siitä välttämättä tarvitsee huomioida. Liikkumismenetelmäkin oletetaan hoidetuksi sekä reitti annetuksi ylemmältä taholta. Seuraavassa käsitellään itse esteiden ohittamista.

Kuvassa \ref{fig:tilannehahmotelma} on yksinkertaistettu esimerkki tyypillisestä paikallisen esteenväistön ongelmasta. Robottia kuvaa alhaalla oleva ympyrä, määränpäätä ylhäällä oleva ympyrä ja loput kuviot ovat esteitä. Robotti havainnoi edessä päin olevien esteiden reunat näkökentässään: rastit kuvaavat tutkaamalla havaittuja estepisteitä. Nuolet kuvaavat liikkuvien objektien nopeusvektoreita. Kuvan abstraktoitu tilanne voi vastata toimiston käytäviä tai kaupungin liikennettä.

Kuvan tilanteessa robotin on suotuisinta jatkaa matkaa keskellä olevan neliön ohitse, sillä se ei ehdi jarruttaa ja kiertää oikealta. Seuraavaksi täytyy hidastaa, jotta vasemmalta tuleva este pääsee ohitse (mikäli se jatkaa matkaa robotin ohi, eikä käännä suuntaansa nykyisestä). Lopulta kuljetaan nelikulmaisten esteiden välistä päätepistettä päin ja saatetaan joutua väistämään ylempänä olevaa liikkuvaa kappaletta.

\begin{figure}[h]
\centering \includegraphics[width=0.5\textwidth]{tilannehahmotelma}
\caption{Tavanomainen esteenväistötilanne. \label{fig:tilannehahmotelma}}
\end{figure}

TODO: koordinaatistot yms?


\clearpage
\section{Yleisiä esteenväistömenetelmiä}

\subsection{Alkuolettamuksia}

Sisätila eroaa ulkotilasta esteenväistön kannalta merkittävästi siinä, että tilasta voidaan tehdä tiettyjä yksinkertaistavia oletuksia. Robotti on oletettavasti aina samassa kulmassa maanpintaan nähden (tasainen lattia), esteet ovat mitä todennäköisimmin korkeahkoja robottiin nähden ja kohtisuorassa maanpintaan nähden (seinät, hyllyt, ihmiset) ja rakennuksen pohjakuvasta saataneen hyvä kartta, joka voidaan approksimoida kaksiulotteiseksi. Renkailla liikkuminen on helppoa ja yhtäkkisiin kuoppiin tai kynnyksiin ei tarvinne kiinnittää erityisemmin huomiota. Näkymää voi tutkaskannata kohtuullisen luotettavasti jo ultraäänellä. Esteet tuskin liikkuvat ihmistä nopeammin. Mitkään näistä olettamuksista eivät päde ulkona tutkimattomassa ympäristössä.

Ulkona robotin mekaniikkaan, esteenväistöön ja ja -havainnointiin on kiinnitettävä enemmän huomiota. Ulkotilat voidaan erotella edelleen mm. kaupunkimaastoon, työmaahan, peltoon, avolouhoksiin ja kaivoksiin, metsänkaltaiseen maastoajoon jne. Kaupunkimaasto on kompromissi sisätilojen ja erityisen haastavan ympäristön välillä, ja sen teknisiä haasteita ovat erityisesti vinot ja käyrät pinnat joissa robotti lipsuu ja joissa kiinteät anturit voivat ottaa häiriömittauksia maanpinnasta mäkeä alas ajettaessa; ylös ajettaessa reunan yli ei nähdä ennen kuin maasto on taas tasaista. Liikkuvat esteet voivat olla autoja tai polkupyöriä, joita pitäisi väistää hyvin nopeasti ja jotka täytyisi havainnoida jo kaukaa, jotta väistöliikkeen ehtisi tehdä. Tämä on erityisen kriittistä varsinkin robotisoiduissa henkilöautoissa. Täysin raaka vaikeasti kartoitettava epätasainen maasto taas on edelleen hankalimman pään erikoistapaus, kun maastosta ei voida tehdä muita olettamuksia kuin että se on hyvin haastava.

Tasaisessa maastossa ``kaksiulotteisessa'' maailmassa esteet on aina kierrettävä sivulta ja mittauksia on helppo tehdä tutka-antureilla, kun vinoja maastoja ei ole. Seuraavassa käsitellään esteenväistöä tällaisessa maailmassa, sillä se yksinkertaistaa tilannetta huomattavasti. Kaikki tilanteet kannattaa approksimoida kaksiulotteisiksi mikäli vain mahdollista. Monesti ulkotilatkin voidaan vinoudestaan huolimatta käsitellä kaksiulotteisena, ellei robotti lennä tai sukella. Jos edessä on hyvin matalakin este, se kannattanee kiertää elleivät renkaat jousta erityisen paljon.


\subsection{Potentiaalikenttä}

Potentiaalikentät (artificial potential function, artificial potential field, APF) ovat vanha mutta hyvin usein (sellaisenaan tai toisen navigointitavan lähtökohtana) käytetty väistömenetelmä \cite{rimon1992apf} \cite{warren2002apf}. Oikeita fysikaalisia voimia nämä kentät eivät tuota robotille, jolloin kenttiä sanotaan toisinaan keinotekoisiksi tai virtuaalisiksi.

Potentiaalikentät syntyvät kohteesta ja esteistä; kohde tuottaa puoleensavetävän ja esteet hylkivän potentiaalin. Käytetty potentiaalifunktio on suhteellisen yksinkertainen, esimeriksi robotin ja esteen välisen etäisyyden käänteisarvo tai tämän neliö \cite{ge2002new}. Määränpään ja esteiden aiheuttavien potentiaalien gradienttien summasta saadaan robottiin kohdistuva ``voima'' jonka mukaan sitä kiihdytetään. Potentiaalikenttiä käytetään myös robottimanipulaattoreilla, mutta niitä ei tässä käsitellä. Intuitiitivesti potentiaalikenttiä voi verrata vuoristoisen maaston korkeuskarttaan, jossa pyritään ``vierimään'' mahdollisimman alas pohjalle, määränpäähän.

Formaalisti potentiaalifunktiot $U_a$ (puoleensavetävä, attraktiivinen) ja $U_r$ (hylkivä, repulsiivinen) ovat esimerkiksi \cite{ge2002new}
\begin{equation} \label{eq:uapot}
U_a(q) = \xi(q_m - q),
\end{equation}
\begin{equation} \label{eq:urpot}
U_r(q) = \begin{cases}
 \eta(\frac{1}{|q_e - q|} - \frac{1}{\rho_0})^2 & \text{jos } |q_e - q| \le \rho_0 \\
0 & \text{jos } |q_e - q| > \rho_0
\end{cases}
\end{equation}
missä $q$-vektori kuvaa robotin sijaintia, $q_m$ kohteen sijaintia ja $q_e$ yhden esteen sijaintia. $\xi$ ja $\eta$ ovat optimoitavia skaalauskertoimia ja $\rho_0$ on suurin käytännöllinen etäisyys, jossa este havaitaan tai jossa se tuottaa merkittävää voimaa. Voima $F$ saadaan yleisesti potentiaalikenttäfunktion negatiivisesta gradientista paikan suhteen
\begin{equation}
F(q) = -\nabla_q U(q),
\end{equation}
oli potentiaalifunktio $U(q)$ mikä tahansa (kuten kaava \ref{eq:uapot} tai \ref{eq:urpot}, tai jokin muu), sillä halutaan päästä ``korkeuskarttaa'' pitkin alaspäin. Kokonaisvoima $F_{kok}$ on kohteen ja kaikkien esteiden yhteenlaskettujen voimien summa, kun esteitä on $N$ kpl,
\begin{equation}
F_{kok}(q) = F_a(q) + \sum_i=1^N F_{ri}(q).
\end{equation}

\begin{figure}[h!tb]
\centering \includegraphics[width=\textwidth]{potentiaalia}
\caption{Yksinkertaistettu esimerkkikuva potentiaalikartasta. \label{fig:potentiaalia}}
\end{figure}

Kuvassa \ref{fig:potentiaalia} on esimerkki potentiaalifunktion arvoista erittäin yksinkertaisessa ympäristössä. Kohde on origossa ja siellä on siis matalin potentiaali. Neljä huippua ovat pistemäisiä esteitä joista kolmen ryppäänä olevan takana on yksi lokaali minimi, johon voi jäädä loukkuun ilman muita menetelmiä. Käytetyt potentiaalifunktiot ovat \ref{eq:uapot} ja \ref{eq:urpot} arvoilla $\xi = 1, \eta = 10, \rho_0 = 3$. Todellisudessa esteitä lienee joka puolella ja monen pistemäisen estemittauksen yhdistelmä tuottaa viivamaisia kuvioita seinien yms. kohdille.

Koska voima voidaan laskea hetkellisesti joka pisteessä ja potentiaalifunktioiden laskeminen on yksinkertaista, tämä menetelmä soveltuu dynaamiseen ja reaaliaikaiseen tilanteeseen. Etäisyys esteeseen saadaan esim. ultraäänianturilta, ja esteiden liikkuessa repulsiivinen kokonaisvoima muuttuu siten, että robotti ohjaa esteistä poispäin jatkuvasti. Menetelmä ei ota kantaa esteiden liikkumiseen vaan yksinkertaisesti määrää robottia hylkimään esteitä silloin kun ne ovat havaintosäteellä. [Sense-act]

[Kuva voimavektoreista]

(Etäisyysmittareiden epävarmuudet eivät merkittävästi tätä tekniikkaa haittaa, sillä mittauksia saadaan jatkuvasti ja kun jokaiselle etäisyyspisteelle lasketaan voima, häviävät satunnaiset häiriömittaukset suhteessa mitättöminä pois. Esteinä voidaan käyttää pisteitä, jotka on havaittu parin viime skannausiteraation sisällä. Abstraktin luonteensa ansiosta menetelmä on sovellettavissa myös villin luonnon haastaviin tilanteisiin.)

Eri painokertoimet $\xi$, $\eta$ ja $\rho_0$ on optimoitava robotin kinematiikan ja esteiden mukaan \cite{ge2002new}; robotin liike on jatkuvaa eikä se voi välttämättä kääntyä välittömästi mihin suuntaan tahansa. Sillä on myös massasta aiheutuva hitaus sekä jokin maksiminopeus, joista täytyy optimoida kenttien voimakkuus siten, ettei esteitä kierretä turhaan hyvin kaukaa, mutta samalla siten, ettei niihin voi törmätä. Tässäkin on tehtävä myös oletuksia esteiden liikkumisnopeudesta ja robotin reaktioajasta, jos se on relevanttia -- potentiaalikentät eivät ehdi apuun nokkakolareihin jos hylkimisvoima ei ole tarpeeksi suuri. Painoparametrien optimoinniksi on esitetty etukäteen suunniteltavan hyvyysfunktion minimointia \cite{vadakkepat2002eapf}, mikä sopii ennalta laskettavaksi muttei kelpaa muuttuvaan ennalta tuntemattomaan ympäristöön tekemättä alkuoletuksia [ESIMERKKI].

Menetelmä toimii hyvin yksinkertaisissa ja avarissa ympäristöissä, mutta siinä on silti tiettyjä ongelmia, jotka on otettava huomioon ja joiden mukaan on jalostettava menetelmää hieman eteenpäin tilanteen mukaan \cite{ge2002new}. Lokaaleihin minimeihin voi jäädä loukkuun, lähekkäin olevien esteiden välistä ei pääse, kapeissa käytävissä syntyy helposti värähtelyä sekä määränpäähän voi olla mahdotonta päästä, jos sen toisella puolella on lähellä este. [REFACTOR]

Lokaalin minimin ongelmaan on esitetty useita samaan menetelmään integroitavia ratkaisuja. Lokaali minimi on paikallinen pieni potentiaalikuoppa, jonne jouduttuaan robotti ei pääse sieltä pois omin avuin tällä menetelmällä. Yksi mahdollinen ratkaisu on poistumisvoima, joka otetaan käyttöön jos huomataan robotin olevan lähellä minimiä, esimerkiksi ennakkoon potentiaalikartasta tulkitsemalla. Tällöin kokonaisvoimaan lisätään esteiden hylkivää vaikutusta sopivaan suuntaan \cite{vadakkepat2002eapf}.

On myös ehdotettu robotin takana samaa rataa kulkevaa virtuaalista estettä, joka aiheuttaa voiman eteenpäin ja estää nollapotentiaalikuoppiin jumiutumisen \cite{thurau2004learning}. Tässäkin on ongelmana ko. voiman suuruuden optimointi: liian pieni voima on hyödytön ja liian suuri työntää robottia turhaan väärään suuntaan ja aiheuttaa hitautta ja voi estää kohteeseen pääsemisen luullen sitä lokaaliksi minimiksi.

Koska potentiaalikentät ovat niin universaali ohjaustapa, niihin voidaan yhdistää muita menetelmiä rinnalle; kun huomataan, että minimikuoppa on lähistöllä, globaali reitinsuunnittelija voi aiemmin anturoidun ympäristön mukaan ohjata robottia toisen suuntaan virtuaalisella lisävoimalla tai jopa ohjata samaa polkua taaksepäin ja yrittää toista suuntaa esteiden ohi.

Potentiaalikenttä ovat teoriassa yksinkertainen, universaali menetelmä, ja sitä käytetään monen muun menetelmän pohjana [ref,ref,ref]. Sellaisenaan siihen liittyy kuitenkin käytännön ongelmia, joihin on kehitettävä tilannepohjaisesti ratkaisu esim. globaalin suunnittelijan kautta [ref].

[-- irrallisia lauseita, yhdistele]

\subsection{Ohjauskulman huomiointi}

Muun muassa ohjauskulmakentäksi (steer angle field) \cite{feiten2002robust} ja kaarinopeusmetodiksi (curvature-velocity method) \cite{simmons2002curvature} kutsuttu menetelmä ottaa huomioon robotin kinematiikasta sen, että kaarella kulkevaan robottiin -- esim. differentiaaliajoa tai Ackermannin ohjausta (henkilöauton kinematiikkaa) käyttävään -- ei välttämättä kannata kohdistaa kiihtyvyyttä kohtisuoraan kaarta vastaan jos haluaisi sen mahdollisimman äkkiä poispäin vieressä olevasta esteestä, koska robotti voi vain hetkellisesti kääntyä enemmän vasemmalle tai oikealle. Kyseessä ei sinänsä ole suoranaisesti esteenväistömenetelmä, vaan tapa kartoittaa reitit joita robotti ylipäätään voi kulkea.

Vastaava lähestymistapa on Foxin yms. \cite{fox2002dynwin} esittämässä dynaamisessa ikkunassa (dynamic window approach), joka painottuu robotin mahdollisten kiihtyvyyksien mukaan valittaviin suuntiin ja kaariin, jotka eivät törmää valitulla nopeudella mihinkään esteeseen. Kaarista valitaan erikseen soveltuvin polku, jota pitkin kuljetaan seuraavaksi. (Tähän tullee lisää tekstiä...)
% TODO

Kuvassa \ref{fig:ajolinjoi} esitetään eri kaaria, joita differentiaaliajoinen eli kahdella erikseen ohjattavalla renkaalla käänneltävä robotti pystyy kulkemaan, kun sillä on tietty vauhti josta ei ehditä jarruttaa tai kääntyä aivan toiseen suuntaan. Kaaria on periaatteessa ääretön määrä, joista kuvaan on yksinkertaistettu muutama. Tasaista vauhtia kulkemalla ko. robotti ajaa aina suoraan tai ympyrän kaarta pitkin. Suurempi nopeus myös rajoittaa kääntökulmaa, mikäli halutaan estää renkaiden lipsuminen [REF]: hitaammin ajamalla voi kääntyä tiukempia mutkia. Kuvan robotti ei esimerkiksi pysty lähtemään välittömästi suoraan vasemmalle.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.3\textwidth]{ajolinjoi}
\caption{Robotin ajolinjoja. Oikealle ei voi kääntyä lainkaan, koska esteeseen törmääminen olisi väistämätöntä. \label{fig:ajolinjoi}}
\end{figure}

TODO: kuvaan nopeusviiva ja koordinaatistoi?


\subsection{Varmuusruudukko}

Varmuusruudukko tai varausruudukko (certainty grid, occupancy grid) on yksi tapa esittää ympäristön esteet \cite{elfes2002occugrid} ja toimii monien muiden menetelmien pohjana. Sen ideana on nimensä mukaisesti rakentaa ruudukko robotin globaalista työavaruudesta, johon päivitetään anturien tietoa siitä, millä varmuudella ruudussa on este. Kun robotin havaitsema maailma jaetaan sopivan kokoisiin ruutuihin, voi sen jatkokäsittely yksinkertaistua algoritmista riippuen hyvinkin paljon. Kompromisseja tarkkuuden ja tehokkuuden välillä tehdään ruudun koossa: suurilla ruuduilla maailma approksimoituu vain muutamaksi ruuduksi joiden läpikäynti on nopeaa, ja useammilla pienemmillä ruuduilla saadaan tarkkuutta laskentatehon kustannuksella. Ruudukko voidaan myös yhdistää globaaliin karttaan ympäristöstä, jolloin sen avulla voidaan estimoida paikkaa \cite{schiele1994comparison}.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.5\textwidth]{certaintygrid}
\caption{Esimerkki varmuusruudukosta \cite{borenstein2002vfh}. \label{fig:certaintygrid}}
\end{figure}

Kuvassa \ref{fig:certaintygrid} on Borensteinin ja Korenin testitilanne varmuusarvoruudukkona koko havainnoista (ilman ruudukon ruutuviivoja). Suuremmat pisteet kuvaavat suurempaa varmuusarvoa eli sellaista, josta on saatu enemmän mittauksia. active window -laatikko kuvaa ``ikkunaa'' johon tällä hetkellä kiinnitetään huomiota: robotin ei tarvitse ottaa huomioon koko varmuusarvoruudukon maailmaa vaan ainoastaan pieni alue robotin ympäriltä jonka sisältä laskettavat voimat ovat merkittäviä suunnan suhteen -- täten laskennan haastavuus ei kasva sitä mukaa kun saadaan lisää havaintoja ympäristöstä.


\subsection{Histogrammit}

Selvennä!

Borenstein ja Koren \cite{koren1991potential} toteavat potentiaalikentät riittämättömiksi ja esittävät niihin ja varmuusruudukkoon pohjautuvan virtuaalisen voimakentän (virtual force field, VFF) ja siitä edelleen kehittyneen vektorikenttähistogrammin (vector field histogram, VFH) \cite{borenstein2002vfh, borenstein2002realtime}. Virtuaalinen voimakenttä perustuu Borensteinin ja Korenin työssä varmuusruudukkoon, jonka ruutuihin summataan arvoja robotin 24 ultraäänianturilta. Tästä ruudukosta otetaan tietyn kokoinen neliö robotin sijainnin kohdalta (kuten kuvassa \ref{fig:certaintygrid}), jota päivitetään mittauksia saadessa ja josta lasketaan robotin suuntaa ja nopeutta ohjaava voima samankaltaisesti kun potentiaalikentissä: lähellä olevat esteet tuottavat voimakkaita hylkiviä voimia. Esteiksi lasketaan ruudukot, joissa on mittauksia; mittausten määrä kuvaa esteen kokoa ja kompensoi täten myös epävarmuuksia ja häiriömittauksia.

\begin{figure}[h!t!]
\centering \includegraphics[width=0.7\textwidth]{histogram}
\caption{Borensteinin ja Korenin kuva histogrammeista. Ylempänä itse histogrammi eli estevarmuus kulman funktiona, alempana sama tulkittuna varmuusarvoruudukon päälle. \label{fig:histogram}}
\end{figure}

Borenstein ja Koren \cite{borenstein2002vfh} toteavat että suoraan kaksiulotteisesta kartasta voiman tulkitseminen menettää liikaa informaatiota, ja ottavat käyttöön toisen laskentavaiheen, histogrammitaulukon. Histogrammi kattaa täyden ympyrän robotin ympärillä, ja sen joka sektorille summataan asteittain varmuusarvoruudukon arvot niistä ruuduista, jotka kullekin sektoreille osuvat. Histogrammiin syntyy huippuja ja laaksoja. Täysi ympyrä jaetaan esimerkiksi viiden asteen sektoreihin, joista jokaiseen summataan varmuusruudukon ruuduista ne, jotka osuvat kullekin sektorille. Laaksot ilmaisevat alueita, joita on turvallista lähestyä; korkeat huiput kuvaavat paikkoja, joissa on todennäköisesti jokin lähellä oleva tai suuri este, jota on väistettävä.

% (Potentiaalikenttien pahimmat ongelmat -- lokaali minimi ja värähtely kapeissa käytävissä -- vähenevät tai häviävät kokonaan kun tämä menetelmä ottaa päinvastaisen lähtökohdan ja etsii liikettä rajoittavien esteiden sijaan alueita, jonne saa liikkua eikä häiriinny pahasti reunoilla olevista esteistä.)

Kuvassa \ref{fig:histogram} havainnollistetaan vektorikenttähistogrammin toiminta. Histogrammiin muodostuu suuria arvoja niihin kohtiin, mitä vastaavissa suunnissa on suurella todennäköisyydellä esteitä. Reitti valitaan suuntaan, jossa on suurin tyhjä aukko histogrammissa eli jossa lienee varmimmin kuljettava reitti. Koska histogrammimenetelmä hakee esteiden sijaan parhaan suunnan johon voi ajaa, se ei saa robottia jumiin \cite{borenstein2002vfh}. [TODO: Selitä miksi.]

Iso ruudukko tuo isoja vaihteluita diskreetin luonteensa takia, jolloin tarvitaan kokeellisesti viritettävä alipäästösuodin ettei ohjaukseen tulisi suuria yhtäkkisiä vaihteluita \cite{borenstein2002vfh}. Tätä voitaisiin hieman korjata ottamalla huomioon robotin sijainti ruutunsa sisällä sen sijaan, että ainoastaan laskettaisiin vain näiden suurten (esim. 10*10 cm) ruutujen etäisyyksiä. Voitaisiin myös kompensoida ohjauksen vaihtelua lisäämällä algoritmiin heuristiikkaa esim. suoraan ajamisesta: jos turvallisen lähestymisen laakson suunta ei suuremmin eroa nykysuunnasta, ei suuntaa kannata merkittävästi vaihtaa. [TODO: pohdintoihin, siisti konditionaaleja]

Menetelmä soveltuu mittausten korkeatasoisen tulkintansa ansiosta erityisesti häiriöiseen ja epävarmaan mittaukseen, ja sitä onkin testattu ultraäänisensoreilla joihin liittyy lähes ominaisesti epävarmuutta, vahinkokaikuja ja vierekkäisten sensorien ristivaikutusta \cite{borenstein2002vfh}. Histogrammiin jaettavan sektorin epäsuotuisuus lasketaan varmuusruudukon arvojen neliöistä, jolloin varmempia mittauksia painotetaan huomattavasti enemmän, ja pienet, häiriömäiset mittaukset jäävät lähes huomiotta. Borenstein ja Koren testasivat VFH:ta robotillaan, jossa on 24 ultraäänianturia jaettu täydelle ympyrälle joka suuntaan; tekniikka onkin selvästi suunniteltu tutkatyyppisille etäisyysantureille, joilta saadaan pistemäisiä mittauksia. Tässä yhteydessä on ulkotiloissa otettava huomioon maaston epätasaisuus, sillä muutoin oletetaan tutkan olevan saman suuntainen maatason kanssa ja vino maasto joka saa robotin kallistumaan tekee mittaukset hyödyttömiksi. [TODO: varmuusruudukkoon]

VFH ei kuitenkaan ota huomioon robotin kinematiikkaa millään lailla, vaan olettaa että robotti on pistemäinen ja voi vaihtaa kulkusuuntaansa välittömästi. Borenstein ja Ulrich esittävät VFH+-algoritmin, joka korjaa tämän ongelman \cite{ulrich2002vfh+}. He tutkivat ihmisvoimin työnnettävää, differentiaaliajoa (kaksi erillistä vetävää pyörää) käyttävää robottia ohjaamaan sokkoa ihmistä. Tämä eroaa kinematiikaltaan oleellisesti aiemmin käytetystä, joka suuntaan ajavasta robotista.

VFH+ tuo seuraavat parannukset: Robotti oletetaan pistemäiseksi ja esteitä vastaavasti kasvatetaan robotin koon ja muodon tuomien rajoitteiden mukaan, jolloin alipäästösuodinta ei tarvita. Histogrammikartasta tehdään ensin binäärinen kartta kahden kynnysarvon avulla. Tämän jälkeen karttaa laajennetaan edelleen peittämään ne suunnat, joihin robotti ei ehdi kääntymään kinematiikkansa takia. Nämä lasketaan tässä tilanteessa kääntösäteen avulla. Lisäksi ohjaussuunnan valinnassa käytetään apuna hyvyysfunktiota, jolla voidaan painottaa erilaisia ominaisuuksia vapaista suunnista. % TODO: (Tähän ehkä esimerkkikaava hyvyysfunktiosta.)
% TODOOOO

VFH+:sta vielä edelleen kehitetty VFH* käyttää A*-hakualgoritmia etsimään oikean valinnan saman laatuisista poluista, ja näkee täten hieman kauemmas. \cite{ulrich2002vfhstar} (Jatkoa seuraa...)

% tääkin varmuusruudukkoon? varmuusruudukko on abstraktiokerros blaa blaa
Algoritmin luonteeseen kuuluvan staattisen, jatkuvasti päivitettävän maailmankartan takia VFH ja sen johdannaiset soveltuvat sellaisenaan huonosti liikkuvien esteiden väistämiseen; eri hetkillä liikkuva esine havaitaan eri kohdissa, jolloin esine piirtää karttaan ``seinän'' reittinsä kohdalle. Varmemmilla sensoreilla voitaisiin laaja kartta unohtaa ja käyttää vain hetkittäisiä mittauksia histogrammin rakentamiseen. Näin liikkuvien esteiden vanhat sijainnit eivät vaikuttaisi.


\subsection{Törmäyskeila}
% (Tämä osa vaatii selvennystä.) PALJON. TODO TODO.

Chakravarthyn ja Ghosen \cite{chakravarthy2002cone} trigonometrinen törmäyskeilamenetelmä kuvaa hyvin abstraktilla tasolla, miten kaksi liikkuvaa pistettä, ympyrää tai lopulta mielivaltaisen muotoista kappaletta törmäävät. Pisteen ja toisen kappaleen välinen ``huono'' kulkualue muodostaa kolmion, jonka yhdessä kulmassa on piste ja toiset kulmat ovat kappaleen ulkoreunoilla siten, että koko kappale mahtuu näin muodostuvaan sektoriin. Menetelmä kertoo, missä kulmissa robotin keskipiste voi kulkea törmäämisen estämiseksi. Jos robotin suuntaa ajatellaan kolmion kärjestä lähtevänä nopeusvektorina, se ei saa olla sektorin sisällä. Väistösuunnan valinta on siis yksinkertaisesti nopeuden valinta sellaiseen suuntaan, joka ei osu keilan (tai keilojen, kun esteitä on useita) sisälle.

Sellaisenaan menetelmä vaatii, että robotin ympäristön esteet tunnetaan kokonaisina kappaleina pistemäisten mittausten sijaan, ellei pistemäisiä mittauksia approksimoida jonkin kokoisiksi ympyröiksi. Lisäksi kappaleiden nopeudet on estimoitava pelkästään etäisyystiedon perusteella. Chakravarthy ja Ghose toisaalta esittävät samalla yksinkertaistavia approksimaatioita mielivaltaisen muotoisille kappaleille, jolloin voidaan käyttää pelkkiä ympyröitä ja laskenta helpottuu.


\subsection{Muuta}

Alunperin vihivaunut eli automaattitrukit käyttivät mekaanisia hätä-seis-kytkimiä huomaamaan törmäämiset [ref,ref]. Tällainen tunnistaminen ei kuitenkaan sovellu ennaltaehkäisevään esteenväistöön, sillä mekaanisen havaitsemisen yhteydessä esteeseen on jo törmätty. Myös esteenväistön rinnalla voidaan käyttää hätä-seis-kytkimiä, jos ei voida olla varmoja siitä, voiko esim. kasvillisuuden läpi mennä vai tuleeko siellä vastaan huomaamaton este [se yks ref].

Tietynlaista yleistä heuristiikkaakin on tutkittu mm. sumean logiikan avulla [ref]. Sumea logiikka käyttää hyväkseen ihmisille tuttuja ohjaussääntöjä: jos edessä vasemmalla näkyy este, renkaita ohjataan oikealle. Jos este on lähellä, hidastetaan vauhtia. jos este on hyvin lähellä, hidastetaan entistäkin kovempaa.


\clearpage
\section{Sovelluksia} % TODO: tms? aiemmin "laajempia tapoja"

[TODO: selitä mitä tässä sectiossa on tulossa, reffit kuntoon]

Edellä esiteltiin erilaisia puhtaan laskennallisia menetelmiä lokaaliin esteenväistöön. Näistä kaikki keskittyvät vain siihen, että edessä tai ympärillä on jokin tällä hetkellä tietyssä kohdassa oleva este reitin päällä, jolloin se on kierrettävä; tällaista tunnistusalgoritmia ajetaan jatkuvasti tiedoilla nykyhetkestä ja menneestä. Esitellyt algoritmit eivät ota kantaa maaston haastavuuteen, pinnanmuotoihin tai liikkuviin esteisiin.

Nykypintaan suhteessa hyvin vinoon mäkeen ei kannata lähteä kulkemaan, sillä robotti saattaa keikahtaa ympäri. Myös epätasaista maastoa kannattaa väistää, mikäli se on kierrettävissä tasaisen maaston kautta. Sama kannattaa tehdä upottavalle maastolle, jos tienpinnan pehmeys on havainnoitavissa.

Lisäksi reittiä voi dynaamisessa ympäristössä suunnitella korkeammalla abstraktiotasolla siten, että sensoridatasta tulkitaan edelleen erikseen paikallaan olevat ja liikkuvat hahmot. Liikkuvien hahmojen pohjalta suunnitellaan reitti kauemmas ja tarkemmin kuin hetkelliselle väistöliikkeelle: voidaan olettaa niiden kulkevan suoraa reittiä vielä hetken verran ja päätellä, kannattaako este kiertää takakautta odottamalla että se ajaa ohitse.


\subsection{Haastava ympäristö}

Sisätilat ja kaupunkimaastot ovat rakennettua ympäristöä, josta voi olettaa lukuisia yksinkertaistuksia. Rakentamaton maasto eli metsät, suot, muut kasvillisuudet ja kivikkoiset alueet ovat vaikeita, sillä maa ei ole tasainen eivätkä esteet ole korkeita tai kohtisuoria suhteessa maahan. Esteiksi on luokiteltava myös vaarallisen vinot mäet sekä kuopat. Kuoppia kutsutaan toisinaan negatiivisiksi esteiksi (negative obstacle). Tavallaan [TODO ??] aiempana esitettyjä väistömenetelmiä voidaan soveltaa varsin suoraan myös tällaiseen maastoon -- esteiden havainnointi ja tulkinta tosin eroaa oleellisesti rakennetun ympäristön havainnointitoiminnasta, mutteivät ne vaikuta itse väistämistoiminnon laskemiseen. Vino maasto tai syvät kuopat voidaan havainnoida konenäöllä ja merkitä edelleen varausruudukkoon väistettävinä kohteina. Maastosta voidaan kerätä lisäinformaatiota kuten pinnan epätasaisuutta, joka voidaan merkitä karttaan alueiden ominaisuutena joka syötetään reitinhaun hyvyysfunktiolle painokertoimena. [REF]

Schäferin ym. \cite{schafer2005stereo} nelipyöräinen robotti on varustettu stereonäöllä sekä kolmiulotteisella laserskannerilla, ja tuottaa ohjauksen käyttäytymispohjaisesti. Korkeisiin mäkiin ja hyvällä tiellä pysymiseen sekä esteiden väistöön varaudutaan erikseen; eri heuristiset käyttäytymismallit näille tuottavat vihjeitä etu- ja takarenkaiden kääntökulmalle ja nopeudelle. Mallit toimivat sumean logiikan kaltaisesti: jos oikealla näkyy este, pyritään kääntymään vasemmalle. Esteet (sekä hankalat maastot että konkreettisesti läpipääsemättömät kappaleet) havaitaan pääasiassa syvyysnäön epäjatkuvuuskohtien avulla maaston geometriasta.

Toisessa tutkimuksessa Schäfer ym. \cite{schafer20083d} tutkivat nimenomaan kasvillisuuspainotteista maastoa, jossa harvojen kasviesteiden tunnistaminen on haastavampaa. Tässä stereonäön ja laserskannauksen avuksi on liitetty kosketusanturi robotin eteen. Kun edessä huomataan harvaa ja mahdollisesti joustavaa kasvillisuutta, edetään silti eteenpäin mutta hidastetaan huomattavasti, jolloin kosketusanturi ehtii ilmoittaa turvallisesti mahdollisesta törmäyksestä kiinteään kappaleeseen kasvillisuuden sisällä. Jatkoa seuraa...


\subsection{Liikkuvat esteet}

Aiemmin esitellyt menetelmät soveltuvat liikkuvienkin esteiden väistämiseen, sillä niitä lasketaan jatkuvasti aina uudelleen uusista havainnoista. Kun esteiden sijainnit muuttuvat, myös esteenväistön tuottama ohjaus robotille muuttuu. Jos tiedetään ennalta esteiden sijaintien lisäksi niiden nopeudet, niin voidaan ennakoida koko ympäristön käyttäytymistä ja osittain kumota myöhemmin tapahtuvan liikettä monimutkaistavan esteenväistön tarvetta oikealla reitin valinnalla. Esimerkiksi risteystilanteessa omaa reittiä vasten kohtisuoraan sivusta tuleva este voi aiheuttaa jarruttamisen tarvetta mikäli robotti väistää sitä vasta lähelle päästyään. Ennakoiden voidaan kääntää reittiä siten, että ei nopeutta ei tarvitse vähentää ja päästään esteen edestä tai takaa siten, että törmäystä ei synny. [TODO: selvennä.]

\subsubsection{Havainnointi}

Riittävän tarkoista mittauksista voidaan estimoida perättäisten mittausten eroista ympäristön muutoksia, kun robotin nopeudesta tiedetään, millä lailla paikallaan seisovien esteiden havainnointi muuttuisi robotin liikkuessa. 

Prassler ym. \cite{prassler2002roboticswheelchair} käyttävät varausruudukon kaltaista aikaleimakarttaa havaintopisteiden varastoimiseen ja erottelevat siitä liikkuvat esteet paikallaan olevista tutkimalla kartan historiatietoa. Edellisten ajanhetkien ruudukoista etsitään ruudukon nykyhetken tiettyä mittaussolua vastaava solu, ja verrataan sen lähistöllä olevia mittauksia. Riittävän lähellä oleva mittaus lasketaan stationääriseksi; kaukana oleva taas on todennäköisimmin liikkuva kappale.

\subsubsection{Väistäminen}

Liikkuville esteille käytetty, Fiorinin ja Shillerin \cite{fiorini1998motion, fiorini2002motion} esittämä nopeusestemalli (velocity obstacle), myös suhteellisen nopeuden mallina (relative velocity approach) tunnettu, jatkaa törmäyskeilaideaa erityisesti liikkuville esteille. Malli ottaa huomioon esteiden nopeudet ja muodostaa nopeusvektorien keskinäisestä suhteesta toisen keilan, joka kuvaa mihin suuntaan liikkuminen aiheuttaa törmäyksen ja mihin suuntiin kulkemalla taataan turvallinen reitti.

Mallia käytetään yksinkertaistettuna pistemäiselle robotille ja ympyrän muotoisille esteille -- approksimoimalla molemmat ympyröiksi voidaan siirtää robotin oma koko esteisiin suurentamalla esteiden sädettä robotin säteellä [REF]. Malli ei ota kantaa esteiden havainnointitapaan vaan olettaa esteille tunnetut nopeudet, joista lasketaan suhteellinen nopeus itse robottiin nähden, oletetaan nopeudet vakioiksi ja lasketaan, millä robotin nopeusvektoreilla törmäys aiheutuisi johonkin aikaan tulevaisuudessa nykyhetkestä laskien. Robotti ei kuitenkaan kulje suoraa linjaa, eivätkä tosielämässä esteidenkään nopeusvektorit ole välttämättä vakioita -- menetelmää iteroidaan tihein aikavälein, jolloin ennakoidaan esteen väistäminen hyvissä ajoin.

\begin{figure}[h!tb]
\centering \includegraphics[width=0.6\textwidth]{velobj}
\caption{Törmäyskeila $CC_{A,B}$ ja nopeuseste $VO_B$. Robotti on pisteessä $A$, estettä kuvaa ympyrä pisteessä $B$. \cite{prassler2002roboticswheelchair}. \label{fig:velobj}}
\end{figure}

% TODO: symbolit!

Kuvassa \ref{fig:velobj} nopeusvektorit ($v_a$ robotin nopeus, $v_b$ esteen nopeus), törmäyskeila ja nopeuseste. Nopeusvektorin kärki ei saa olla esteen sisässä, jottei törmäystä tapahtuisi jollain ajanhetkellä tulevaisuudessa. On huomioitava myös robotin maksiminopeus; $v_a$:lla on jokin maksimipituus. Nopeuseste lasketaan Minkowskin summana törmäyskeilasta ja $v_b$:stä \cite{van2008reciprocal}. Formaalisti tämä määritellään seuraavasti:

(Tähän pari peruskaavaa.)

Kun näin on saatu aikaan kartta hyväksyttävistä nopeuksista, valitaan niistä suosituin [MITEN?]. On otettava huomioon, että vain nopeusvektorin lähistöllä olevat alueet ovat kelvollisia -- robotin massan ja sitä mukaa maksimikiihtyvyyden mukaan karttaan approksimoidaan monesti suorakaide nykyhetken nopeusvektorin pään ympärille.

Koska etäisyysanturoinnit ovat monesti pisteluonteisia, sopii ympyräapproksimaatio väistöön varsin hyvin; peräkkäiset pisteet tuottavat näin vastaavan estoliikkeen kuin kaikkien pisteiden muotoinen viiva tai suorakaide. [REF]

Fulgenzi ym. \cite{fulgenzi2007dynamic} simuloivat nopeusesteitä laajennettuna todennäköisyyksillä ja varausruudukolla.

Van den Berg ym. kehittivät nopeusesteitä edelleen pienin parannuksin, ja lukuisilla kappaleilla simuloidut tulokset esittävät luotettavaa ja sileää käytöstä \cite{van2008reciprocal}. Tässä oletetaan, että muutkin liikkuvat esteet käyttäytyvät suurin piirtein samalla tavalla kohdatessaan esteen. Jne...


\subsection{Lokaali ja globaali reititys}

(Tai jotain yleisempää. Osiota mietittävä. Avaa lisää! Kaava/kuva?)

Stentz ja Hebert \cite{stentz1995complete} esittävät jeeppiin asennetun, laserskannerilla havainnoivan ja gps:n ja odometrian yhdistelmällä paikkaa seuraavan järjestelmän. Järjestelmä yhdistää globaalin ja lokaalin navigoinnin. Se käyttää D*-algoritmia (kuten A*, mutta parannuksilla dynaamiseen ympäristöön kun reittiä joudutaan laskemaan useasti [todocite]) etsimään ennakkotietoon pohjautuvasta tiedosta optimaalisen globaalin reitin tavoitteeseen. Samalla sen lokaali navigointi antaa vihjeitä paikallisista esteistä laserskannauksen avulla. Erillinen välittäjäosa [HÄH?] ohjaa näiden molempien tietojen perusteella renkaita: molemmat antavat vihjeen kääntyä vasemmalle tai oikealle. Esteenväistöä painotetaan kertoimella 0.9 ja globaalia reitinhakua kertoimella 0.1, jolloin pysytään reitillä mutta mennään esteiden ohitse \cite[s. 18]{stentz1995complete}.

Myös Kelly esittää tutkimuksessaan jeeppiin kytketyn navigaattorin, joka ottaa ennustavasti huomioon useita eri haasteita joita saattaa valittavalla reitillä tulla ongelmaksi. \cite{kelly1995intelligent} Algoritmi ottaa huomioon törmäysten ja tavoitteen haun lisäksi mm. liian suuren kääntökulman, jarrutustehon ja muut kinematiikasta aiheutuvat rajoitteet kaarinopeusmetodin lailla. Koska kyseessä on ``tavallinen'' auto, algoritmi ehdottaa suoraa vauhtia sekä eturenkaille tiettyä kääntökulmaa, jota ennustetaan tietty lyhyt matka eteenpäin. Eri kääntökulmista seuraavat polut tutkitaan kartasta, ja näille lasketaan haastavuusarvot histogrammiksi. Histogrammit summataan yhteen jolloin paras yhteinen hyvyysarvo valitsee suuntakulman. Antureina tässä jeepissä ovat laseretäisyysanturi ja stereokamera. Näiden tuottamista informaatiosta etsitään adaptiivisesti jyrkkiä reunoja, joiden ympäristöä tarkastellaan. Kelly väittää menetelmän toimivan jopa 30 km/h vauhdissa.

Aiempia vastaavalla tavalla toimii myös Singhin ym. kuvaama navigointi, joka yhdistää lokaalin ja globaalin liikkeensuunnittelun \cite{singh2002recent}. Globaalisti käytetään D*:ä kuten aiemmin. Lokaali suunnittelija perustuu Kellyn tutkimukseen ja ottaa lisäksi huomioon ympäristön epävarmuuden; kartan pisteillä on varmuusarvoja, jotka vanhenevat robotin liikkuessa suhteessa matkan pituuteen, ja samalla uusille mittauksille alustetaan varmempi arvo.

Syvyysnäkö stereokameralla, varausruudukko, maamerkkejä ja potentiaalikenttiä \cite{murray2002stereo}.

Michels ym. Yhdelläkin kameralla tyydyttäviä tuloksia opettamalla järjestelmälle ennalta otetuista kuvista syvyyksiä. \cite{michels2005high}

Anturien yhdistelyä jotenkin \cite{ohya2002vision}


\subsection{Neuroverkot}

Neuroverkot perustuvat ihmisten aivojen imitoimiseen ja koostuvat tietystä määrästä sisään- ja ulostuloneuroneja sekä välissä olevasta kerroksesta, joka voi sisältää mielivaltaisen määrän neuroneja päättelyjen tekemiseen. Tapa on erityisen matemaattinen ja toimii matalalla tasolla: neuroni saa syötteeksi lukuja, ja mikäli niistä laskettu painotettu summa ylittää raja-arvon, neuroni antaa ulostuloksi esimerkiksi luvun 1, muutoin luvun 0.

Neuroverkkoja on sovellettu sekä liikkuville roboteille että manipulaattoreille \cite{glasius1995neural}. Tapa ei ole erityisen nopea ja vaatii verkon ennalta opettamisen, jotta tietty syöte tuottaisi oikeanlaisen vasteen. Toisaalta on saatu myös reaaliaikaiseen laskemiseen kykeneviä tuloksia dynaamisessa ympäristössä \cite{yang2000neural}.

Myös täysin toisenlaista lähtökohtaa on ehdotettu robotin reitillä pysymiseen; Pomerleaun neuroverkolla toimiva konenäköjärjestelmä seuraa autotietä syöttämällä kuvan yläreunan pisteet verkolle, joka antaa vasteena hyvyysarvon eri suuntiin kääntymiselle \cite{pomerleau1989alvinn}. Tämä tapa ei väistä itse esteitä mitenkään. Tämä tekniikka saattaa olla hieman yliampuva tähän tarkoitukseen -- yhtä hyvin voitaisiin jaotella kuvan ylälaita kolmeen osaan, josta keskimmäinen kuvaa tietä, ja tästä tutkittaisiin kuinka lähellä kuvan keskiosaa tie kulkee.


\subsection{Geneettiset algoritmit}

Geneettinen algoritmi (GA) toimii intuitiivisesti ja luonnonmukaisesti evoluution lailla arpomalla alkupopulaation josta kehitetään eteenpäin uusia mutaatiolla ja risteyttämällä. Uusien ehdokkaiden hakua iteroidaan, kunnes erityisen hyvyysfunktion arvo on riittävä. Tämäkin on abstrakti ja matalan matemaattinen menetelmä, ja esimeriksi mutatointi onnistuu oikein valitulla mallilla aina vaihtamalla satunnaisesti jonkun populaation ``kromosomin'' lukuarvo toiseksi riippumatta siitä, mitä luvut esittävät.

Tässä yhteydessä populaatio on lista solmupisteistä kartalla, joiden kautta reitti kulkee haluttuun kohteeseen. Hyvyysfunktio tuottaa hyviä arvoja lyhyistä ja mutkattomista reiteistä, ja erityisen suuria, varmasti hylättäviä ratkaisuja toteuttamiskelvottomista reiteistä jotka kulkevat esteiden lävitse \cite{nearchou1998pathgene}. Solmupisteet voidaan valita kartalta mistä tahansa pisteistä, tai valintaa voidaan yksinkertaistaa muodostamalla kartasta ruudukko (sopii yhteen hyvin mm. varmuusruudukkoon) jonka jokainen ruutu on mahdollinen solmukohta \cite{hu2004knowgene} \cite{sugihara2002genetic}.

Geneettiset algoritmit tuottavat aina kelvollisia polkuja, ja hyvyysfunktion valinnalla sekä algoritmin sisäisen toiminnan optimoinnilla, eli sillä kuinka solmupistereitti kuvataan populaationa, voidaan algoritmista saada tarkka ja nopeahko. Suurella kartalla GA:n iterointi voi silti kestää liian pitkään jotta sitä voisi käyttää reaaliajassa. Toinen ongelma on vaatimus kartasta: algoritmi on muihin verrattuna raskas ja liian monipuolinen erittäin paikalliseen reitinsuunnitteluun, ja globaaliin suunnitteluun se taas vaatii karttaa pidemmälle kuin mitä antureilla voidaan saada, eikä siis sovellu kovin hyvin paikalliseen esteenväistöön.


\clearpage
\section{Yhteenveto ja pohdintaa}

Lähes kaikki robottien lähialueen liikkeensuunnittelualgoritmit pohjautuvat jossain määrin samoihin, monesti tutkittuihin vanhoihin aiheisiin. Esteenväistöalgoritmin valinnassa ja optimoinnissa tulee kiinnittää huomiota erityisesti robotin kinematiikkaan ja ympäristöön jossa se tulee liikkumaan. Sisätiloissa ultraäänianturit ja vektorikenttähistogrammi (tai sen johdannaiset) riittävät hyvin, kunhan histogrammin kartta kattaa vain lähialueen eikä koko ``maailmaa'' mikäli tilassa on useita liikkuvia ihmisiä ellei kartan varmuusarvoja vanhenneta. Liikkuvat esteet voidaan tunnistaa etsimällä perättäisistä mittauksista vastaavat pisteet ja tutkimalla niiden liikkumisnopeuksia.

Erilaisista mahdollisista reiteistä voidaan valita suosituin eri kriteereillä VFH+:n käyttämän hyvyysfunktion lailla. Aina ei välttämättä kannata ajaa suoraan tavoitepistettä kohti, jos toinen reitti minimoisi jarruttelun, liikkuvien esteiden läheltä kulkemisen, maaston haastavuuden tai muun reitin lyhyyden sijaan optimoitavan kriteerin.

Liikkuvat kappaleet tuskin koskaan ovat vain yhden mittauspisteen kokoisia, jolloin lähekkäisiä pisteitä voidaan yhdistää vertaamalla niiden keskinäisiä nopeuksia: suunnilleen saman nopeuksiset pisteet luultavasti kuuluvat samaan kappaleeseen. Tästä voidaan sitten estimoida keskikohta massakeskipisteen avulla. Täten väistämisen suhteen tutkittavia esteitä on vähemmän.

Liikkuviin esteisiin tulee kiinnittää huomiota pääasiassa kahdella eri tavalla: ensinnäkin liikkumaan kykenevän esteen ei voi olettaa olevan samassa kohdassa, mikäli kohtaan palataan myöhemmin -- jos jonkinlaista karttaa rakennetaan, on sensoreilta saataville karttapisteille hahmoteltava varmuusluvut jotka ikääntyvät pikkuhiljaa, jolloin epävarmat esteet unohdetaan eikä niiden pohjalta voi pitkän ajan päästä suunnitella reittiä. Toisekseen, jos robotilla on erityinen kiire tai jos haetaan esim. ihmisten lähellä hyvin toimivaa käyttäytymistä, voidaan tunnistaa liikkuvat objektit jo havainnointivaiheessa ja esim. risteystilanteessa odottaa hetki, että nopeampi sivulta päin tuleva este menisi ohi.

Ulkotiloissa järkevä anturointi on kolmiulotteinen laserskannaus yhdistettynä yhteen tai useampaan kameraan. Ulkona liikkuvat robotit ovat helposti auton mallisia ja ajavat mahdollisesti kovaa vauhtia ympyrän kaaren mallisilla radoilla, eivätkä potentiaalikenttiin perustuvat tavat välttämättä ole tarpeeksi nopeita: varsinkin kaupunkiolosuhteissa esteitä havainnoidaan yleensä vain edestä ja niitä väistetään vasemmalle tai oikealle sekä mahdollisesti jarruttamalla. Tällöin lokaali esteenväistö muodostuu edessä olevien hahmojen havaitsemisesta ja robotin (usein auton) ohjaamisesta vasempaan tai oikeaan esteen ohitse nopeusestemenetelmällä ja renkaiden rajat huomioiden kaarinopeusmetodilla.

Jos tiedetään ennalta millaiseen ympäristöön robotti viedään, voidaan tehdä yksinkertaistavia heuristiikkoja anturidatalle sekä esteille. Henkilöautoa automatisoidessa voidaan hyvin suurella todennäköisyydellä olettaa, että se ajaa autoteillä ja siten etsiä maanpinnasta kaistaviivoja (jolloin ohjaus ei tosin toimi lumella) sekä kiinnittää huomiota ennalta mm. risteystilanteisiin ja kaistanvaihtoihin. Kävelytiellä kulkeva robotti taas voisi yrittää etsiä talon seinää vierestä, joka auttaisi kulkemaan suoraan. Haastavassa maastossa on muistettava maaston kuopat ja vinot mäet sekä kasvillisuus jonka läpi saattaa kyetä ajamaan vaikka kasvit olisivatkin korkeita.

Lisää...

\clearpage
\addcontentsline{toc}{section}{Viitteet}
\bibliography{kandi}


\end{document}
