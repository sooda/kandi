\documentclass[finnish,12pt]{article}
\usepackage{aaltothesis}
\usepackage{natbib}
\bibliographystyle{plain} % finplain

% \usepackage[utf8]{inputenc}
%% Jos kytt latex-komentoa knnettess (oletusarvo) 
%% kuvat kannattaa tehd eps-muotoon. l kyt ps-muotoisia kuvia!
%% Kyt seuraavaa latex-komennon ja eps-kuvien kanssa 
%%
%% Use this if you run latex and use eps-format pictures
\usepackage[dvips]{graphicx}

%% Jos ts kytt pdflatex-komentoa, 
%% joka knt tekstin suoraan pdf-tiedostoksi ja kuvasi
%% ovat esim. jpg-formaatissa tai pdf-formaatissa,   
%% kytetn seuraavaa pakettia, kommentoi siis kommenttimerkki pois
%% Huom! Tekstin marginaalit saattavat poiketa n. 2-5 mm
%% suosituksesta, jos kytt pdflatex-komentoa!
%% 
%% Use this if you run pdflatex and use jpg/pdf-format pictures
%% Note that margins are not correct with pdflatex output. 
%\usepackage[pdftex]{graphicx} 

%% Saat pdf-tiedoston viittaukset ja linkit kuntoon seuraavalla paketilla.
%% Paketti toimii erityisen hyvin pdflatexin kanssa. 
%%
%% Use this if you want to get links and nice output with pdflatex
\usepackage[pdfpagemode=None,colorlinks=true,urlcolor=red,%
linkcolor=blue,citecolor=black,pdfstartview=FitH]{hyperref}

%% Jos et jostain syyst tykk kytt
%% edellist hyperref pakettia, voit kytt mys seuraavaa pakettia
%% (tarvitaan lhinn url-komennon mrittmiseen ja formatoimiseen)
%%
%% Use this if you do not like hyperref package - this
%% defines url environment and formats it correctly

% \usepackage{url}
%% Matematiikan fontteja, symboleja ja muotoiluja lis, nit tarvitaan usein 
%%
%% Use this if you write hard core mathematics, these are usually needed
\usepackage{amsfonts,amssymb,amsbsy}  
\usepackage{amsmath}
%% Vaakasuunnan mitat, L KOSKE!
\setlength{\hoffset}{-1in}
\setlength{\oddsidemargin}{35mm}
\setlength{\evensidemargin}{25mm}
\setlength{\textwidth}{15cm}
%% Pystysuunnan mitat, L KOSKE!
\setlength{\voffset}{-1in}
\setlength{\headsep}{7mm}
\setlength{\headheight}{1em}
\setlength{\topmargin}{25mm-\headheight-\headsep}
\setlength{\textheight}{23cm}


%% Kaikki mik paperille tulostuu, on tmn jlkeen
%%
%% Output starts here
\begin{document}

%% Korjaa vastaamaan korkeakouluasi
%%
%% Change the school field to describe your school 
\university{aalto university}{Aalto-yliopisto}
\school{School of science and technology}{Teknillinen korkeakoulu}

%% Korjaa seuraavat vastaamaan omaa tiedekuntaasi
%%
%% Change the faculty field to describe your faculty
\faculty{Faculty of Electronics, Communications and Automation}%
{Elektroniikan, tietoliikenteen ja automaation tiedekunta}%
%%

%% Vain kanditylle: Korjaa seuraavat vastaamaan tutkinto-ohjelmaasi
%%
%% Only for B.Sc. thesis: Choose your degree programme. 
\degreeprogram{Automation and control engineering}%
{Automaatio- ja säätötekniikka}
%%

%% Vain DI/M.Sc.- ja lisensiaatintylle: valitse laitos, 
%% professuuri ja sen professuurikoodi. 
%%
%% Only for M.Sc. and Licentiate thesis: Choose your department,
%% professorship and professorship code. 
%\department{Department of Radio Science and Technology}%
%{Radiotieteen ja -tekniikan laitos}
%\professorship{Circuit theory}{Piiriteoria}
%\code{S-55}
%%

%% Valitse yksi nist kolmesta
%%
%% Choose one of these:
\univdegree{BSc}
%\univdegree{MSc}
%\univdegree{Lic}

\author{Konsta Hölttä}

%% Opinnytteen otsikko tulee vain thn. l tavuta otsikkoa ja
%% vlt liian pitk otsikkoteksti. Jos latex ryhmittelee otsikon
%% huonosti, voit joutua pakottamaan rivinvaihdon \\ kontrollimerkill.
%% Muista ett otsikkoja ei tavuteta! 
%% Jos otsikossa on ja-sana, se ei j rivin viimeiseksi sanaksi 
%% vaan aloittaa uuden rivin.
%% 
%% Your thesis title. If the title is very long and the latex 
%% does unsatisfactory job of breaking the lines, you will have to
%% break the lines yourself with \\ control character. 
%% Do not hyphenate titles.
% TODO
\thesistitle{}{Liikkuvien robottien paikallinen esteenväistö ja liikkeensuunnittelu dynaamisessa ympäristössä}

\place{Espoo}
%% Kandidaatintyn pivmr on sen esityspivmr! 
%% 
%% For B.Sc. thesis use the date when you present your thesis. 
\date{x.y.2010}

%% Kandidaattiseminaarin vastuuopettaja tai diplomityn valvoja.
%% Huomaa titteliss "\" -merkki pisteen jlkeen, 
%% ennen vlilynti ja seuraavaa merkkijonoa. 
%% Nin tehdn, koska kyseess ei ole lauseen loppu, jonka jlkeen tulee 
%% hieman pidempi vli vaan halutaan tavallinen vli.
%%
%% B.Sc. or M.Sc. thesis supervisor 
%% Note the "\" after the comma. This forces the following space to be 
%% a normal interword space, not the space that starts a new sentence. 
\supervisor{D.Sc.\ Ilkka Seilonen}{TkT Ilkka Seilonen}

%% Kandidaatintyn ohjaaja(t) tai diplomityn ohjaaja(t)
%% 
%% B.Sc. or M.Sc. thesis instructor(s)
%\instructor{Prof. Pirjo Professori}{Prof. Pirjo Professori}
\instructor{D.Sc.\ (Tech.) Jari Saarinen}{TkT Jari Saarinen}
%\instructor{M.Sc.\ (Tech.) Polli Pohjaaja}{DI Polli Pohjaaja}

%% Aaltologo: syntaksi: \uselogo{red|blue|yellow}{?|!|''}
%% Logon kieli on sama kuin dokumentin kieli
%%
%% Aalto logo: syntax: \uselogo{red|blue|yellow}{?|!|''} 
%% Logo language is set to be the same as the document language.
\uselogo{red}{''}{tkk}
\makecoverpage

\keywords{liikkuva robotti, paikannus, lokaali liikkeensuunnittelu, esteenväistö}

\begin{abstractpage}[finnish]
Liikkuviin robotteihin ja niihin liittyvään esteenväistöön liittyy lukuisia asioita havainnoinnista reitinlaskuun. Tässä työssä kartoitetaan reaaliaikaisia menetelmiä liikkuvien robottien lähellä olevien esteiden väistämiseen ja tästä aiheutuvaan lyhyen kantaman liikkeensuunnitteluun. Pääpaino on ympäristöllä, josta ei juurikaan tiedetä mitään etukäteen ja jossa on todennäköistä joutua väistämään liikkuviakin esteitä.

Sivutaan myös käsitteitä, joista esteenväistössä on oleellista tietää perusteet: eritellään joitakin eri anturointitekniikoita robotin ympäristön ``näkemiseen'' ja robotin itsensä paikan sekä reitin seuraamiseen. Tutkitaan niihin soveltuvia esteentunnistusalgoritmeja ja robotin ohjaustapoja ja -malleja maaliin mahdollisimman optimaalisella tavalla pääsemiseksi osumatta reitillä oleviin stationaarisiin ja liikkuviin esteisiin.
\end{abstractpage}

\newpage

\mysection{Esipuhe}
Moi.

\vspace{5cm}
Otaniemi, x.y.2010

\vspace{5mm}
{\hfill Konsta Hölttä \hspace{1cm}}

\newpage


%% Sisllysluettelo
%% addcontentsline tekee pdf-tiedostoon viitteen sisllysluetteloa varten
\addcontentsline{toc}{section}{Sisällysluettelo}
\tableofcontents

\mysection{Symbolit ja lyhenteet}

\subsection*{Lyhenteet}

\begin{tabular}{ll}
VFH &	vector field histogram \\
DWA &	dynamic window approach \\
AGV &	automated guided vehicle \\
RRT &	rapidly-exploring random tree \\
SLAM &	simultaneous localization and map building \\
SIFT &	scale-invariant feature transform
\end{tabular}


%% Sivulaskurin viilausta opinnytteen vaatimusten mukaan:
\cleardoublepage
\storeinipagenumber
\pagenumbering{arabic}
\setcounter{page}{1}



\section{Johdanto}

\thispagestyle{empty}

Tämän tekstin tarkoituksena on kartoittaa yleisellä tasolla eri esteenväistömenetelmiä eri kohteisiin, erityisesti ulkotiloissa maanpinnalla vaihtelevassa ja dynaamisessa ympäristössä kulkeviin robotteihin. Dynaamisella ympäristöllä tarkoitetaan sellaista, jossa esteet ovat vaihtelevia ja voivat liikkua. Tässä (ja myöhemmin) robotilla tarkoitetaan itsenäisesti liikkuvaa ajoneuvoa, kuten AGV:tä tai automaattisesti ajavaa henkilöautoa, eikä kiinteästi asennettavaa robottia kuten manipulaattorikäsivartta.

Lokaaliin anturipohjaiseen esteenväistöön on luonnollisesti monia eri menetelmiä, joiden hyödyllisyys ja soveltuvuus riippuu robotin ympäristöstä ja anturien laadusta. Universaalia kaikkialle sopivaa lokaalia esteenväistöä ja/tai liikkeensuunnittelua ei ole olemassa. On tosin monia yleisiä menetelmiä ja tilannekohtaista heuristiikkaa. Myös perinteisistä menetelmistä osittain jalostettuja, kehittyneempiä tapoja on saatu kartoittamalla heikkoudet ja soveltamalla tiettyyn ympäristöön; monia tutkimuksia on testattu käytännössä, toisia simuloimalla ja jotkut ovat jääneet vain teoreettisiksi pohdinnoiksi ja kaavoiksi.

Globaalia liikkeensuunnittelua (eli kartta tiedossa etukäteen jonka mukaan reitti suunnitellaan) ja sen yhdistämistä lokaaliin esteiden kiertämiseen sivutaan myös hieman. Tässä työssä keskitytään kuitenkin yhtäkkisten, odottamattomien esteiden havaitsemiseen ja väistämiseen kun jonkinlainen maalipiste on tiedossa ennalta. Reitin ja/tai ympäristön muutoksia saatetaan myös päivittää robotille reaaliajassa. Aina ei kuitenkaan voida saada mitään ennakkotietoa ympäristöstä, jossa robotti kulkee; tällöin tieto pitää kartoittaa matkan varrella. Globaalin reitin suunnittelu oletetaan hoidetuksi; ei oteta kantaa, tuleeko reitti jostain ylempää vai lasketaanko sitäkin reaaliajassa itse robotilla.

Esteitä on havainnoitava jatkuvasti ja niitä voi luonnollisesti väistää vasta havaitsemisen jälkeen. Jotkin väistöalgoritmit liittyvät tiiviisti tiettyihin antureihin, ja anturien hyvät ja huonot puolet on muutenkin otettava huomioon mm. kohinan ja epävarmuuksien takia. Yleisiä havainnointimenetelmiä ovat ultraääni- ja infrapuna-anturit, laserskannerit ja videokamerat. Hyvillä menetelmillä anturointi onnistuu jatkuvasti; toisilla robotti joutuu välillä pysähtymään mittauksia varten. Pyritään siihen, että robotti voi ajaa jatkuvasti pysähtymättä.

Esteiden ohi selviämisen lisäksi robotin on pysyttävä reitillään ja sen on jotenkin saatava tietoa sijainnistaan ja suunnastaan. Tämäkin riippuu robotin antureista ja niiden sopivuudesta ympäristöön. Yleisesti käytettyjä tapoja paikannukseen ovat mm. odometria, maamerkit, gps, erityiset radiomajakat ja näkyvien seinien/maanmuotojen vertaaminen karttaan. Kaikki tavat ovat tosin jossain määrin epätarkkoja, joten virhearviot on otettava huomioon ja mielellään käytettävä useampaa tapaa rinnakkain. Kalman-suodin on varsin suosittu reitin ja sijainnin tarkastelun yhteydessä.

\clearpage
\section{Joku pohjustus}

Robotin navigoinnin pohjalla on hyvin paljon muitakin ongelmia, joita tässä tekstissä saatetaan sivuta sen verran kuin on tarpeen, muttei niihin oteta tarkemmin kantaa, vaan ne oletetaan ratkaistuiksi. Seuraavassa esitellään joitain perusasioita pyörillä kulkevan robotin liikkumisesta. 

Pyörät ovat yksinkertaisen mutta toimivan tekniikkansa vuoksi ylivoimaisesti useimpien nykyrobottien liikkumisen perustana \cite{siegwart2004introduction}. Haastavassa maastossa käytetään jotain pyöristä jalostettua tapaa, kuten telaketjuja tai renkaita, joihin on kiinnitetty piikkejä tms. \cite{abad2009axelwheel} \cite{saranli2001rhex}. Rakenteen puolesta (renkaiden lukumäärä ja kääntyminen) pyörillä liikkumiseenkin on hyvin monia tapoja, joissa on kaikissa omat hyvät ja huonot puolensa. Tekniikka valittakoon robotin muodon ja kohdeympäristön mukaan; jotkut anturoinnit soveltuvat vain tietynlaisille rakenteille.

% TODO: refactor / remove
% Usein käytettyjä ovat differentiaaliajo (kaksi erikseen ohjattavaa vetävää pyörää, ja mahdollisesti useampia tasoittamaan painoa; myös telaketjuajo on differentiaalinen), Ackermannin ohjaus (autoissa käytetty), synkroniajo (synchro drive, kaikki pyörät osoittavat samaan suuntaan ja pyörivät yhtä nopeasti -- robotin rungon orientaatio pysyy samana), ja jokasuuntainen ajo (omnidirectional drive; erikoinen tuplarengasrakenne (omni wheel, mecanum wheel) jossa pinta voi pyöriä kohtisuoraan rengasta vasten \cite{damoto2006holonomicomni} \cite{diegel2002improvedmecanum}). Robotin mekaniikka on otettava huomioon mm. suunnan muutoksissa; esim. tavallinen auto ajaa ympyrän kaarella ja kiihtyy vain eteen- ja taaksepäin, ja synkroniajo ei oikein sovellu kuin tolppamaiselle robotille, sillä se ei salli rungon kääntymistä.

Nivelletyillä jaloilla käveleviä robotteja tutkitaan nykyään yhä enemmän. Humanoidirobotit soveltuisivat hyvin ihmisille tarkoitettuun ympäristöön, ja näyttäisivät ihmisille luontevilta jolloin kanssakäyminen olisi helppoa ja ne voisivat hoitaa ihmisten tehtäviä yleisellä tasolla. Nivelletyt jalat sopivat myöskin haastavaan, epätasaiseen maastoon pyöreitä renkaita paremmin vaikkei olisikaan ihmisten kaltaisista roboteista kyse. Tätä on kokeiltu esimeriksi metsäkoneissa (Plustech Timberjack \cite{billingsley2008robotics}). Monimutkaisen rakenteensa vuoksi ne eivät ole vielä juurikaan yleistyneet.


% \clearpage
% \section{Paikannus ja ympäristön havainnointi}% \section{Navigointi ja liikkeensuunnittelu yleisesti}

Itse esteiden väistämisen aiheuttaman reitin lokaali suunnittelu on puhtaan laskennallista, mutta pohjalla on kuitenkin oikea ulkomaailma epätarkkuuksineen ja anturivirheineen. Jotkin menetelmät perustuvat hyvinkin vahvasti tietynlaiseen anturointitapaan, kuten siihen, että ultraääneltä saadaan suhteellisen epävarmoja mittauksia. Virheet ja epävarmuudet on pidettävä aina mielessä. %Tässä osiossa raapaistaan hieman eri havainnointikeinojen pintoja ja tutustutaan siihen, mitä tulee esteenväistöalgoritmeissa ottaa huomioon. Myöhemmin näitä ei enää erotella, ellei se ole väistömenetelmälle kovin oleellista.

% \subsection{Paikannus}

Olennainen ongelma liikkuville roboteille on itsensä paikannus \cite{borenstein1996whereami}. Kun robotin oletetaan tietävän kohdepiste tarkasti, on myös tiedettävä missä itse robotti sijaitsee. Tähän voidaan käyttää tapauksesta riippuen esim. odometriaa, inertiasuunnistusta, majakoita tai maamerkkejä (kamerakuvalla tai maanpinnasta "kosketuksella" havaittavia). Sensorifuusiota Kalman-suotimella voidaan myös hyödyntää, jolloin saadaan tarkempi tulos monen anturin yhdistetystä mittauksesta.

% clip...

Odometria ja inertiasuunnistus ovat integroivia menetelmiä, ja täten pienetkin virheet kasautuvat pidemmän päälle, joten niitä ei voi käyttää yksinään. Odometria seuraa esim. pyörimisanturien avulla renkaiden liikkettä ja arvioi kuljettua matkaa; yleisiä virhelähteitä ovat renkaiden liukuminen, niiden väärin mitattu ympärysmitta ja keskinäinen etäisyys, sekä ympäristön epäsystemaattiset virheet, kuten tuntemattomien ulkoisten häiriötekijöiden osuminen robottiin. Inertiasuunnistus integroi kiihtyvyysanturien mittauksia, ja on käytössä lähinnä jos renkaista tms. ei saada mitattua mitään -- ei kovin yleinen maanpinnalla kulkeville roboteille. Epävarmojen mittauksien integrointi luonnollisesti kerryttää virhettä pidemmän päälle, ja paikkaa kannattaa seurata ja korjata esim. GPS:llä jos mahdollista.

Absoluuttisten paikantamisen käyttö yhdistettynä edellisiin korjaa kertymävirheet. GPS on standardoitu paikannusmenetelmä, joka toimii käytännössä missä tahansa maapallolla ulkotiloissa, kun näkyvyys satelliitteihin on riittävä \cite{borenstein1997postech}. Parempaa vaatiessa ajoympäristöön voitaisiin rakentaa itse vastaava majakkajärjestelmä, ja monen robotin ollessa kyseessä robotit voivat myös keskustella keskenään siten, että jokainen toimii kiinteiden majakoiden lisäksi yhtenä majakkana \cite{dorigo2005swarm}.

Majakat käyttävät paikannukseen useimmiten kolmiomittausta, joka voi olla paikallisena hyvinkin tarkka. Odometrialla voidaan mitata hetkittäin paikallista liikettä, jota korjataan globaalisti majakoilla ajoittain integrointivirheiden eliminoimiseksi. Hetkellinen nopeus ja suuntakulma saadaan odometrialta varsin tarkasti. (TODO: ref) Tällaista kolmiomittausta on yleisesti kahta lajia: radiosignaaleilla toimivia, kuten GPS, ja maamerkeistä tulkattavia vertaamalla ennalta tunnettuun karttaan \cite{leonard199geombeac}.

Maamerkit ovat yleinen käytäntö mm. AGV-vaunujen navigoinnissa. Varastotiloissa voidaan upottaa lattiaan magneetteja tai induktionauhaa sekä kiinnittää seinään heijastimia, joiden etäisyys selvitetään laserilla ja joista lasketaan trigonometrian avulla robotin sijainti majakoiden tyyliin. Lattiaan kiinnitettävät maamerkit auttavat, kun näköetäisyys heijastimiin on huono, sekä antavat myös varsin tarkan hetkellistiedon sijainnista, kunhan osataan erottaa maamerkit toisistaan.

Maamerkkejä voidaan käyttää myös konenäön yhteydessä, kun ympäristöä kuvataan (video)kameralla. Tällöin havainnoidaan ympäristöstä tunnisteita vastaavasti kuten ultraäänitutkakuvan vertaaminen tunnettuun karttaan tapahtuu \cite{betke2002mobilelandmarks}. Tämä on tarkempaa ja samalla huomattavasti laskennallisesti haastavampaa kuin tutka-antureiden tilanteessa.

Maamerkkien suurin ongelma on se keskeinen oletus, että ympäristöstä on ennalta olemassa jo jokin kartta, eikä tapa siis täysin tuntemattomassa ympäristössä toimi. Karttaa voidaan toisaalta rakentaa samalla kun liikutaan tuntemattomassa ympäristössä, jolloin samassa paikassa paikannus on jälkeenpäin tarkempaa, kun karttatieto on kerätty aiemmin (SLAM) \cite{se2002mobilelocalization}.
 

\subsection{Havainnointi}

Esteet on etsittävä robotin lähistöltä jollain lailla. Suosittuja tapoja ovat ultraäänianturit, laserskannerit ja kamerat. Seuraavassa esitellään niiden perusasioita, jotka on muistettava esteenväistöä suunnitellessa.

Ultraääni on yksinkertaisuutensa ja edullisuutensa ansiosta usein käytetty \cite{borenstein1988obstacleus}. Ultraääniskanneri lähettää äänipulssin ja laskee aikaa takaisin tulevaan kaikuun. Kun äänen nopeus tunnetaan, voidaan laskea kaiun heijastaneen esteen etäisyys. Yksinkertaisuus tuo tosin myös monia ongelmia: anturit ovat hitaita ja havainnoivat kauempana olevat esteet epätarkemmin, sillä niiden lähettämä kaiku levenee keilamaisesti. Ääniaaltoon suhteessa vinottain olevat esteet voivat jäädä havaitsematta, koska ääniaalto ei heijastu takaisin. Monesti käytetään myös useita antureita vierekkäin, jolloin saadaan leveä näkökenttä; tällöin viereisten anturien mittaukset saattavat heijastua toisilleen ("crosstalk") \cite{borenstein2002vfh}.

Laserskannereita on pääasiassa kahta tyyppiä: yksi- ja kaksiulotteisia. Yksiulotteiset pyörivät jatkuvasti ja skannaavat 360 asteen tutkakuvaa ympäristöstään; heijastuksista saadaan etäisyyspisteitä kartalle. Kaksiulotteiset skannerit toimivat stereonäkökameran lailla: edessä olevaa näkymää skannataan jatkuvasti tietyllä keilalla ja rasterilla kahdessa ulottuvuudessa, jolloin saadaan arvio edessä olevien esteiden etäisyyksistä. Nämä ovat tyypillisesti erittäin kalliita.

Heijastuksiin perustuvissa mittareissa on aina ongelmana vinojen pintojen havainnointi, kun kaiku ei heijastukaan takaisin robottia päin. Varsinkin ultraääni on tässä kovin huono. \cite{borenstein1988obstacleus}

Kun erityisen tarkkaa kuvaa tarvitaan nopeasti, voidaan käyttää videokameroita jos laskentatehoa riittää. Kahdella hyvin sijoitetulla kameralla onnistuu myös syvyysnäkö. Konenäkö on ylivoimaisesti kaikutekniikkaa parempi, kun tarvitaan tarkempaa tietoa edessä olevista pinnoista, kuten kuviointia tai asentoa. Myöskin kapeiden esteiden havainnointiin se soveltuu paremmin, koska nämä jäisivät kaiuilta helposti ohi. Esimerkiksi automaattiset henkilöautot käyttävät konenäköä tien reunojen havainnointiin (TODO: ref) ja peltoja automaattisesti lannoittavat robotit pysyvät konenäöllä taimien välissä (TODO: peltorobokisaref). Kuvan käsittely reaaliajassa vaatii huomattavasti enemmän konetehoa kuin yksiulotteiset tutkamenetelmät, ja kamera osoittaa vain yhteen suuntaan eikä sillä saada täyden ympyrän mittausta. Suuntaus tosin on harvoin ongelma auton kaltaisissa roboteissa, joissa on selkeä keula.

Tästä eteenpäin oletetaan, että esteet ja lähiympäristö on havaittu jollain menetelmällä, ja tietyllä varmuudella tiedetään ympäristön muoto ja mahdollisesti reitillä oleva este -- menetelmään sen enempää ottamatta kantaa. Keskitytään itse esteiden ohittamiseen.


\clearpage
\section{Tasaisen maaston esteenväistö}

Tämänkin osion otsikko vaatii hiomista.

Sisätiloissa toiminta eroaa ulkotiloista merkittävästi siinä, että tilasta voidaan tehdä muutamia yksinkertaistavia oletuksia. Robotti on oletettavasti aina samassa kulmassa maanpintaan nähden (tasainen lattia), esteet ovat mitä todennäköisimmin korkeahkoja robottiin nähden ja kohtisuorassa maanpintaan nähden (seinät, hyllyt, ihmiset) ja rakennuksen pohjakuvasta saataneen hyvä kartta, joka voidaan approksimoida kaksiulotteiseksi. Renkailla liikkuminen on helppoa ja yhtäkkisiin kuoppiin tai kynnyksiin ei tarvinne kiinnittää huomiota. Näkymää voi tutkaskannata kohtuullisen luotettavasti jo ultraäänellä. Esteet tuskin liikkuvat ihmistä nopeammin. Mitkään näistä olettamuksista eivät päde ulkona tutkimattomassa ympäristössä.

Ulkona jo robotin mekaniikkaan on kiinnitettävä enemmän huomiota, esteenväistöstä ja -havainnoinnista puhumattakaan. Ulkotilat voidaan erotella edelleen kahtia kaupunkimaastoon ja muuhun tuntemattomaan metsään. Kaupunkimaasto on kompromissi sisätilojen ja erityisen haastavan ympäristön välillä, ja sen teknisiä haasteita ovat erityisesti vinot ja käyrät pinnat joissa robotti lipsuu ja joissa kiinteät anturit voivat ottaa häiriömittauksia maanpinnasta mäkeä alas ajettaessa; ylös ajettaessa reunan yli ei nähdä ennen kuin maasto on taas tasaista. Liikkuvat esteet voivat olla autoja tai polkupyöriä, joita pitäisi väistää hyvin nopeasti ja jotka täytyisi havainnoida jo kaukaa, jotta väistöliikkeen ehtisi tehdä. Tämä on erityisen kriittistä varsinkin robotisoiduissa henkilöautoissa.

Tasaisessa maastossa maailma voidaan helposti olettaa kaksiulotteiseksi, jolloin esteet on aina kierrettävä ja mittauksia on helppo tehdä tutka-antureilla, kun vinoja maastoja ei ole. Seuraavassa pohditaan esteenväistöä ``kaksiulotteisessa'' maailmassa, johon kannattaa approksimoida kaikki tilanteet, mikäli mahdollista, sillä se yksinkertaistaa tilannetta huomattavasti. Monesti ulkotilatkin voidaan vinoudestaan huolimatta käsitellä kaksiulotteisena, ellei robotti lennä tai ui. Jos edessä on hyvin matalakin este, se kannattanee kiertää elleivät renkaat jousta erityisen paljon.

Joo-o \cite{bonin2008visual}.


\subsection{Potentiaalikenttä}

Keinopotentiaalikentät (artificial potential functions, artificial potential fields) ovat vanha \cite{warren2002apf}  \cite{rimon1992apf} mutta usein (sellaisenaan tai toisen navigointitavan pohjana) käytetty väistömenetelmä. Mitään oikeita fysikaalisia voimia nämä kentät eivät tuota robotille, jolloin kenttiä sanotaan keinotekoisiksi.

Potentiaalikentät syntyvät maalista ja esteistä; maali tuottaa puoleensavetävän ja esteet hylkivän potentiaalin. Käytetty potentiaalifunktio on esimeriksi etäisyyden käänteisarvo tai sen neliö \cite{ge2002new}. Maalin ja esteiden aiheuttavien potentiaalien gradienttien summasta saadaan robottiin kohdistuva ``voima'' jonka mukaan sitä kiihdytetään. Potentiaalikenttiä käytetään myös robottimanipulaattoreilla, mutta niitä ei tässä käsitellä.

Menetelmä toimii hyvin yksinkertaisissa ympäristöissä, mutta siinä on silti lukuisia ongelmia, jotka on otettava huomioon ja jalostettava menetelmää hieman eteenpäin \cite{ge2002new}. Lokaaleihin minimeihin voi jäädä loukkuun, lähekkäin olevien esteiden välistä ei pääse, kapeissa käytävissä syntyy helposti värähtelyä sekä maaliin voi olla mahdotonta päästä, jos sen toisella puolella on lähellä este.

Potentiaalifunktiot $U_a$ (attraktiivinen) ja $U_r$ (repulsiivinen) ovat esimerkiksi \cite{ge2002new}

\begin{equation}
U_a(q) = \xi(q_g - q),
\end{equation}

\begin{equation}
U_r(q) = \begin{cases}
 \eta(\frac{1}{q_o - q} - \frac{1}{\rho_0})^2 & \text{jos } |(q_o-q)| \ge \rho_0 \\
0 & \text{jos } |q_o-q| \ge \rho_0
\end{cases}
\end{equation}

missä $q$-vektori kuvaa robotin sijaintia, alaindeksi g maalia (goal) ja o estettä (obstacle). ja asentoa ja $\xi$ ja $\eta$ ovat optimoitavia skaalauskertoimia. Voimat saadaan potentiaalikentän gradientista

\begin{equation}
F_a(q) = -\nabla U_a(q) = \xi(q_g - q)
\end{equation}
ja kokonaisvoima on kaikkien yhdistelmä
\begin{equation}
F_{tot}(q) = F_a(q) + \sum F_r(q).
\end{equation}

Potentiaalikentät toimivat parhaiten kun ympäristö on tiedossa, jolloin reittiä voidaan suunnitella kauemmas kerralla. Dynaamisessa ja tuntemattomassa ympäristössä näin ei ole, mutta koska voima lasketaan hetkellisesti ja potentiaalifunktiot ovat suhteellisen yksinkertaisia, soveltuu tämä tekniikka myös haluamaamme tilanteeseen. Etäisyys esteeseen saadaan esim. ultraäänianturilta, ja esteiden liikkuessa voima muuttuu kuten on tarvis.

Eri painokertoimet on optimoitava robotin dynamiikan ja esteiden mukaan \cite{ge2002new}; robotin liike on jatkuvaa ja sillä on jokin massasta aiheutuva hitaus sekä tietty maksiminopeus, joista täytyy optimoida kenttien voimakkuus siten, ettei esteitä kierretä turhaan hyvin kaukaa, mutta samalla siten, että niihin ei voi törmätä. Tässäkin on tehtävä myös jotain oletuksia esteiden liikkumisnopeudesta. Painoparametrien optimoinniksi on esitetty hyvyysfunktion minimointia \cite{vadakkepat2002eapf}, mikä sopii ennalta laskettavaksi muttei kelpaa muuttuvaan ennalta tuntemattomaan ympäristöön.

Minimiongelmaan on esitetty useita ratkaisuja. Yksi mahdollinen on poistumisvoima, joka otetaan käyttöön jos huomataan robotin olevan lähellä minimiä. Tällöin kokonaisvoimaan lisätään esteiden hylkivää vaikutusta \cite{vadakkepat2002eapf}. On myös ehdotettu virtuaalista robotin takana samaa rataa kulkevaa estettä, joka aiheuttaa voiman eteenpäin ja estää nollapotentiaalikuoppiin jumiutumisen \cite{thurau2004learning}. Tässäkin on ongelmana ko. voiman suuruuden optimointi.

Teoriassa kiva, käytännössä hankala optimoida robustiksi ja monipuoliseen ympäristöön soveltuvaksi.


\subsection{Histogrammit}

Borenstein ja Koren toteavat potentiaalikentät riittämättömiksi ja esittävät niihin pohjautuvan virtuaalisen voimakentän (virtual force field) \cite{koren1991potential} ja siitä edelleen kehittyneen vektorikenttähistogrammin (vector field histogram, VFH) \cite{borenstein2002vfh}. Virtuaalinen voimakenttä perustuu karttamaiseen varmuusarvoruudukkoon, jonka ruutuihin summataan arvoja sitä mukaa kun niitä saadaan robotin 24 ultraäänianturilta. Tästä ruudukosta otetaan tietyn kokoinen ($w_s*w_s$) aktiivinen alue, jota päivitetään mittauksia saadessa ja josta lasketaan robotin suuntaa ja nopeutta ohjaava voima samankaltaisesti kun potentiaalikentissä: lähellä olevat esteet tuottavat voimakkaita hylkiviä voimia.

Vektorikenttähistogrammi jalostaa tätä eteenpäin rakentamalla ruudukosta suuntapohjaisen histogrammin. Borenstein ja Koren toteavat että suoraan kaksiulotteisesta kartasta voiman tulkitseminen menettää liikaa informaatiota, ja ottavat käyttöön toisen laskentavaiheen, histogrammiruudukon \cite{borenstein2002vfh}. Histogrammi kattaa täyden ympyrän robotin ympärillä, ja siihen summataan asteittain varmuusarvoruudukon arvot, jolloin siihen syntyy huippuja ja kuoppia. Kuopat ilmaisevat alueita, joita on turvallista lähestyä; korkeat huiput kuvaavat paikkoja, joissa on todennäköisesti jokin lähellä oleva tai suuri este, jota on väistettävä. Iso ruudukko tuo isoja vaihteluita diskreetin luonteensa takia, jolloin tarvitaan alipäästösuodin joka tulee virittää kokeellisesti, ettei ohjaukseen tulisi suuria yhtäkkisiä vaihteluita. Tätä voitaisiin korjata ottamalla huomioon robotin sijainti ruutunsa sisällä sen sijaan, että ainoastaan laskettaisiin vain näiden suurten (esim. 10*10 cm) ruutujen etäisyyksiä.

Tämä tapa soveltuu erityisesti häiriöiseen ja epävarmaan mittaukseen, ja sitä onkin testattu ultraäänisensoreilla joihin liittyy lähes ominaisesti tietynlaista häiriötä. Voima lasketaan varmuusruudukon arvojen neliöistä, jolloin varmempia mittauksia painotetaan huomattavasti enemmän, ja pienet, häiriömäiset mittaukset jäävät robustisti huomiotta. Borenstein ja Koren testasivat VFH:ta CARMEL-robotilla, jossa on 24 ultraäänianturia; tekniikka onkin selvästi suunniteltu tutkatyyppisille etäisyysantureille, joilta saadaan pistemäisiä mittauksia. Tässä yhteydessä on ulkotiloissa otettava huomioon vino maasto, sillä muutoin oletetaan tutkan olevan saman suuntainen maatason kanssa ja vinot kuopat jotka saavat robotin kallistumaan saavat mittaukset hyödyttömiksi.

VFH ei kuitenkaan ota huomioon robotin dynamiikkaa millään lailla, ja olettaa siis että robotti on pistemäinen ja voi vaihtaa kulkusuuntaansa välittömästi. Borenstein ja Ulrich esittävät VFH+-algoritmin, joka korjaa tämän ongelman \cite{ulrich2002vfh+}. He tutkivat ihmisvoimin työnnettävää, differentiaaliajoa käyttävää robottia ohjaamaan sokkoa ihmistä. Tämä eroaa dynamiikaltaan oleellisesti aiemmin käytetystä, joka suuntaan kääntyvästä CARMEL:sta.

VFH+ tuo seuraavat parannukset: Robotti oletetaan pistemäiseksi ja esteitä vastaavasti kasvatetaan robotin koon ja muodon tuomien rajoitteiden mukaan, jolloin alipäästösuodinta ei tarvita. Histogrammikartasta tehdään ensin binäärinen kartta kahden kynnysarvon avulla. Tämän jälkeen karttaa laajennetaan edelleen peittämään ne suunnat, joihin robotti ei ehdi kääntymään dynamiikkansa takia. Lisäksi ohjaussuunnan valinnassa käytetään apuna hyvyysfunktiota, jolla voidaan painottaa erilaisia ominaisuuksia vapaista suunnista.


\subsection{Konenäkö}

Konenäkö yleisesti soveltuu hyvin sisätiloissa seinien ja yksinkertaisten geometrioiden havainnointiin \cite[s. 245]{desouza2002vision}. Ulkotiloissa sisätilojen kaltaisia käytäviä ja huoneita ei ole, jolloin vastaavat menetelmät eivät välttämättä ole suoraan käytettävissä; tosin mikäli edessä on helposti samanlaista materiaalia, kuten puita tai suora autotie \cite[s. 255]{desouza2002vision}, toimii menetelmä hyvin.

Syvyysnäkö stereokameralla on myös varteenotettava vaihtoehto tavanomaisille antureille \cite{murray2002stereo}. Michels et al. esittävät ongelmiksi kohdistuksen, kohinan ja liikkeen sekä tärinän aiheuttaman sumeuden eroavaisuudet kameroiden kuvissa. Yhdelläkin kameralla on saatu tyydyttäviä tuloksia opettamalla järjestelmälle ennalta otetuista kuvista syvyyksiä. \cite{michels2005high}

Kameran voi myös yhdistää ultraäänianturointiin, jolloin ultraääneltä saadaan nopeampi vasteaika liikkuville esteille, ja tarkempi reitin suunnittelu voidaan hoitaa kameran pohjalta, kuten tekivät Ohya et al \cite{ohya2002vision}. Tässä kameran esteet kartoitettiin tosin ennalta määritettyyn karttaan reunantunnistuksella pystyviivoina, eikä tämä menetelmä sovellu ulkotiloihin tuntemattomaan ympäristöön.

Kameralla otetussa kuvassa ei ole esimerkiksi ultraäänisensoreille tyypillistä häiriötä tai epätarkkuutta, mutta se on laskennallisesti raskaampi. Hyvällä resoluutiolla ja pienellä kohinalla tosin saavutetaan näkö suhteellisen pitkälle, mutta kapeammalla keilalla kuin jos robottia ympäröisi 360 asteen tutkavyö. Tämä ei kuitenkaan yleensä ole ongelma, sillä vieressä tai takana olevia esteitä ei tarvitse huomioida eteenpäin ajettaessa. Synkroniajoa käyttävä robotti voi muuttaa suuntaansa välittömästi, jolloin tutkavyöllä säästytään anturien kääntämiseltä. 

\subsection{Neuroverkot}

Neuroverkot soveltuvat sekä liikkuville roboteille että manipulaattoreille. \cite{yang2000neural} Ongelmana muun muassa hitaus verrattuna muihin; enemmänkin globaali kuin nopea lokaali menetelmä. Algoritmin voi opettaa ennalta kartasta hassusti. Entäs kun ei ympäristöä tunneta?

Manipulaattoreille ja tunnetulle kartalle löytyy tutkimusta \cite{yang2004neural}. Kuten myös liikkuvillekin roboteille ennalta halutulle reitille. \cite{noguchi1997path} \cite{glasius1995neural}

\subsection{Geneettiset algoritmit}

Toimii kaikkeen. Ovat tosin hitaita. Globaaliks vaan. Saattaa toisaalta adaptoitua lokaaliin tilanteeseen jonkin toisen menetelmän ohella parantamaan tilannetta.

\subsection{Puumenetelmät}

(Execution extended) Rapidly-exploring random tree \cite{bruce2003rrt} käyttää hyväkseen jo olemassaolevaa dataa ajoympäristöstä ja iteroi robotin varsin hyvin maaliin. Ei taida toimia lokaalisti.

\clearpage
\section{And now for something completely different}

Edellä esiteltiin useita erilaisia menetelmiä lokaaliin esteenväistöön. Näistä tosin kaikki keskittyvät vain siihen, että edessä on jokin tällä hetkellä tietyssä kohdassa oleva este reitin päällä, jolloin se on kierrettävä; tällaista tunnistusalgoritmia iteroitiin jatkuvasti. Reittiä voisi suunnitella hieman korkeammalla tasolla, jossa sensoridatasta tulkitaan todennäköiset paikallaan olevat tai liikkuvat hahmot, ja ennustetaan reitti näiden pohjalta hieman kauemmas ja tarkemmin: esimerkiksi liikkuvat, säännölliset esineet voisi tunnistaa, olettaa niiden kulkevan suoraa reittiä vielä hetken verran, yhdistää robotin omaan nopeuteen sekä tästä tiedosta päätellä, kannattaako este vaikkapa kiertää takaapäin odottaen, että se menee ohi.

Stentz ja Hebert esittävät kokonaiseen autoon asennetun, laserskannerilla havainnoivan ja gps:llä sekä odometrialla paikkaa seuraavan järjestelmän \cite{stentz1995complete}. D*-algoritmi on dynaaminen A*, ja sopii globaaliin reitinhakuun siinä samalla.

D* avaruusrobo, "sumeaa logiikkaa", lokaali+globaali-keskittyminen \cite{singh2002recent}.

\clearpage
\section{Yhteenveto}

bar

\clearpage
\addcontentsline{toc}{section}{Viitteet}
\bibliography{kandi}

\end{document}
